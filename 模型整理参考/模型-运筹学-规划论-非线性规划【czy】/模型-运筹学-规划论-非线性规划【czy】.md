[TOC]

### 模型-运筹学-规划论-非线性规划【czy】

### 1. 模型名称

非线性规划（Nonlinear programming）

### 2. 适用范围

非线性规划是具有**非线性约束条件**或**目标函数**的数学规划。目标函数与约束函数中只要有一个为非线性函数，即称该问题为非线性规划问题(nonlinear programming problem)。

### 3. 形式

#### 3.1 一般形式和参数说明

$$
目标函数 minf(x)
$$

$$
\begin{aligned}

\text { s.t. } &\left\{\begin{array}{l}
g_i(x)\le0 &i=1,2,...,m\\
h_j(x)=0 &j=1,2,...,l\

\end{array}\right.
\end{aligned}
$$

$g_i和h_j$是给定的n元实值函数,称为约束函数 (constraint function)，满足上述约束条件(constraint)

向量$x=(x_1，x_2,...,x_n)$使得实值目标函数 (objective function) $f$ 在 $x$ 处达到最小。

一般称上述问题为数学规划问题 (mathematical programming problem) 或者最优化问题 (optimization problem)。

在上述问题中，满足约束条件的向量 *x* 称为可行解 (feasible solution)，

全体可行解构成的集合称为可行域 (feasible region)。

可行域中使得目标函数值为最小的向量 *x* 称为问题的最优解。最优解一般又分为全局最优解 (Global Optimum)与局部最优解 (Local Optimum)。[^1] 

#### 3.1 特殊形式和参数说明

由约束条件和目标函数的不同类型，非线性规划问题有以下特殊情况：

1. 当目标函数 $f$ 为二次函数，而约束函数 $g_i,h_j$ 均为线性函数时，问题称为二次规划问题 (quadratic programming problem)。
2. 若目标函数 $f$与所有不等式约束函数 $g_i$均为凸函数，而所有等式约束函数 $h_j$均为线性函数，则称问题为凸规划函数 (convex programming problem)。
3. 若约束条件中含有矩阵的半正定条件，则称为半定规划问题 (semi-definite programming problem)

$\cdot$无约束非线性规划：
$$
minf(x)\\
x\in E^{(n)}
$$
$\cdot$有约束非线性规划：

##### 3.1.1 二次规划((quadratic programming)

###### 3.1.1.1 表达式和定义

$$
{min}f(x)=\frac{1}{2}x^TGx+x^Tc\\

s.t.a_i^Tx\geq b_i,i\in tau
$$

其中 *G* 是 Hessian 矩阵。

如果 *G* 是半正定的，则该式为凸二次规划，这种情况下该问题的困难程度类似于线性规划。

如果有至少一个向量满足约束并且在可行域有下界，则凸二次规划问题就有一个全局最小值。如果 *G* 是正定的，则这类二次规划为严格的凸二次规划，那么全局最小值就是唯一的。如果是一个不定矩阵，则为非凸二次规划，这类二次规划更有挑战性，因为它们有多个平稳点和局部极小值点。

##### 3.1.2 凸规划(convex programming)

###### 3.1.2.1 表达式和定义

$$
{min}f(x)\\

s.t. \begin{cases} g_i(x)\leq0,i=1,\cdots,m \\ a_j^Tx=b_j,j=1,\cdots,l \end{cases}
$$

与一般的最优化问题标准形式相比，凸规划有三点附加条件：

**–** 目标函数 *f* 必须是凸函数

**–** 不等式约束函数$g_i$ 必须是凸函数，不等式$g_i\leq 0$组成的区域为凸集

**–** 等式约束函数 $h_j$必须是仿射的 (即线性函数和常函数的和函数)

###### 3.1.2.2 性质

**–** 凸规划问题的任一局部极小点是全局极小点，且全体局部极小点的集合为凸集；

**–** 当凸规划的目标函数 *f* 为严格凸函数时，若存在最优解，则这个最优解一定是唯一的最优解。

###### 3.1.2.3 最优性条件

设凸规划问题中的目标函数 *f* 是可微的，记可行域为$D$，即
$$
D=\lbrace x\mid g_i(x)\leq 0,i=1,2,\cdots,m; a_j^Tx=b_j,j=1,\cdots,l\rbrace
$$
则 $x^*$ 是最优点的充分必要条件是：

对任意的 $y\in D$ ，有
$$
\nabla f(x^*)(y-x^*)\geq0
$$

### 4. 非线性规划问题的解法

#### 4.1 一般算法

![非线性规划 1](C:\Users\Lenovo\Desktop\md截图文件夹\非线性规划 1.png)

#### 4.2 进阶算法

 由于经典算法在处理**大规模问题**时得到的解通常不能保证**全局最优性**，为局部最优解。而进阶算法常常具有跳出局部最优解的机制。

##### 4.2.1 遗传算法

是根据生物演化，模拟演化过程中基因染色体的选择、交叉和变异得到的算法。在进化过程中，较好的个体有较大的生存几率。

##### 4.2.2 模拟退火

是模拟统计物理中固体物质的结晶过程。在退火的过程中，如果搜索到好的解接受；否则，以一定的概率接受不好的解（即实现多样化或变异的思想），达到跳出局部最优解得目的。

##### 4.2.3 神经网络

模拟大脑神经处理的过程，通过各个神经元的竞争和协作，实现选择和变异的过程。

##### 4.2.4 禁忌搜索

模拟人的经验，通过禁忌表记忆最近搜索过程中的历史信息，禁忌某些解，以避免走回头路，达到跳出局部最优解的目的。

##### 4.2.5 蚂蚁算法

模拟蚂蚁的行为，拟人拟物，向蚂蚁的协作方式学习。

#### 4.3 软件求解



![非线性规划 2](C:\Users\Lenovo\Desktop\md截图文件夹\非线性规划 2.png)

### 5. 实例

#### 5.1 例1：经济管理——股票的投资组合问题

##### 5.1.1 问题描述

![非线性规划3](C:\Users\Lenovo\Desktop\md截图文件夹\非线性规划3.png)

##### 5.1.2 符号与假设

| 决策变量$x_i$    | 股票$i$ 的投资比例        |
| ---------------- | ------------------------- |
| $r_i$            | 股票 $i$ 五年的期望收益率 |
| 目标函数 $R$     | 五年后投资组合总收益      |
| 目标函数$Var(R)$ | 投资组合的方差            |
| 目标函数$D$      | 投资组合的标准差          |

##### 5.1.3 模型的建立

$$
R=x_1r_1+x_2r_2+x_3r_3
$$

$$
Var(R)=x_1^2Var(x_1)+x_2^2Var(x_2)+x_3^2Var(x_3)+2x_1x_2Cov(r_1,r_2)+2x_2x_3Cov(r_2,r_3)+2x_1x_3Cov(r_1,r_3)
$$

1. 问题一的模型——二次规划
   $$
   min D=\sqrt{180x_1^2+120x_2^2+140x_3^2+72x_1x_2+220x_1x_3-60x_2x_3}
   $$

$$
s.t. \begin{cases} x_1+x_2+x_3=1 \\ 0.92x_1+0.64x_2+0.41x_3\geq0.65 \\ x_1,x_2,x_3\geq0 \end{cases}
$$

2. 问题二的模型——约束非线性规划
   $$
   maxR=0.92x_1+0.64x_2+0.41x_3
   $$

$$
s.t. \begin{cases} x_1+x_2+x_3=1 \\  \sqrt{180x_1^2+120x_2^2+140x_3^2+72x_1x_2+220x_1x_3-60x_2x_3}\leq12 \\  x_1,x_2,x_3\geq0 \end{cases}
$$

#### 5.2 例2：生产与工程管理——选址问题

##### 5.2.1 问题描述

![非线性规划4](C:\Users\Lenovo\Desktop\md截图文件夹\非线性规划4.png)

 [^2]

##### 5.2.2 符号与假设

![非线性规划5](C:\Users\Lenovo\Desktop\md截图文件夹\非线性规划5.png)

| 决策变量$z_{ij}$ | 从料场$j$ 向工地 $i$ 的运送量为 $z_{ij}$ |
| ---------------- | ---------------------------------------- |
| $(x_j,y_j)$      | 料场$j$的位置                            |
| 目标函数$f$      | 吨千米数                                 |
| $(a_i,b_i)$      | 工地位置                                 |
| $r_j$            | 料场日储量                               |
| $d_i$            | 水泥日用量                               |

##### 5.2.3 模型的建立——约束非线性规划

$$
minf=\sum_{j=1}^{2}\sum_{i=1}^{6}{z_{ij}\sqrt{(x_j-a_i)^2+(y_j-b_i)^2}}

\\

s.t. \begin{cases} \sum_{j=1}^{2}{z_{ij}}=d_{i},i=1,\cdots,6 \\ \sum_{i=1}^{6}{z_{ij}}\leq r_j,j=1,2 \\ z_{ij}\geq0 \end{cases}
$$

### 6. 参考资料

1.  [数学建模培训营----非线性规划](https://anl.sjtu.edu.cn/mcm/docs/1%E6%A8%A1%E5%9E%8B/1%E8%BF%90%E7%AD%B9%E5%AD%A6/1%E8%A7%84%E5%88%92%E8%AE%BA/%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/doc)

[^1]: 在现有的求解算法下，许多非线性规划问题通常只能得到局部最优解，初始值不同则最优解常常不同 (而凸规划的局部最优解即全局最优解)。
[^2]: 这个指标是用运送货物的重量（单位：吨）乘以运送的距离（单位：千米），用来衡量运输企业的运送能力。”