[TOC]

## æ¨¡å‹-è¿ç­¹å­¦-è§„åˆ’è®º-çº¿æ€§è§„åˆ’ã€czyã€‘

### 1. æ¨¡å‹åç§°

çº¿æ€§è§„åˆ’ï¼ˆLinear programmingï¼Œç®€ç§°LPï¼‰

### 2. é€‚ç”¨èŒƒå›´

**çº¿æ€§**çº¦æŸä¸‹**çº¿æ€§**ç›®æ ‡å‡½æ•°çš„**æå€¼**é—®é¢˜çš„æ•°å­¦ç†è®ºå’Œæ–¹æ³•

### 3. å½¢å¼

#### 3.1ä¸€èˆ¬å½¢å¼

1. **å†³ç­–å˜é‡**

   æ¯ä¸€ä¸ªé—®é¢˜éƒ½ç”¨ä¸€ç»„å†³ç­–å˜é‡$(x_1,x_2,â€¦,x_n)$è¡¨ç¤ºæŸä¸€æ–¹æ¡ˆ,è¿™ç»„å†³ç­–å˜é‡çš„å€¼å°±ä»£è¡¨ä¸€ä¸ªå…·ä½“æ–¹æ¡ˆã€‚ä¸€èˆ¬è¿™äº›å˜é‡å–å€¼æ˜¯éè´Ÿä¸”è¿ç»­çš„ã€‚

2. **ç›®æ ‡å‡½æ•°**

   ä¸€ä¸ªè¦æ±‚è¾¾åˆ°çš„ç›®æ ‡,å®ƒå¯ç”¨å†³ç­–å˜é‡çš„çº¿æ€§å‡½æ•°(ç§°ä¸ºç›®æ ‡å‡½æ•°)æ¥è¡¨ç¤ºã€‚æŒ‰é—®é¢˜çš„ä¸åŒ,è¦æ±‚ç›®æ ‡å‡½æ•°å®ç°æœ€å¤§åŒ–æˆ–æœ€å°åŒ–ã€‚

3. **çº¦æŸæ¡ä»¶**

   å­˜åœ¨ä¸€å®šçš„çº¦æŸæ¡ä»¶,è¿™äº›çº¦æŸæ¡ä»¶å¯ä»¥ç”¨ä¸€ç»„çº¿æ€§ç­‰å¼æˆ–çº¿æ€§ä¸ç­‰å¼æ¥è¡¨ç¤ºã€‚

æ»¡è¶³ä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶çš„æ•°å­¦æ¨¡å‹ç§°ä¸º**çº¿æ€§è§„åˆ’çš„æ•°å­¦æ¨¡å‹**ã€‚

å…¶**ä¸€èˆ¬å½¢å¼**ä¸º:
$$
ç›®æ ‡å‡½æ•° max(min)z=c_1x_1+c_2x_2+â€¦+c_nx_n
$$

$$
\begin{aligned}

\text { æ»¡è¶³çº¦æŸæ¡ä»¶ } &\left\{\begin{array}{l}
a_{11} x_{1}+a_{12} x_{2}+\cdots+a_{1 n} x_{n}\leq(=,\geq) b_{1} \\
a_{21} x_{1}+a_{22} x_{2}+\cdots+a_{2 n} x_{n}\leq(=,\geq)b_{2} \\
\cdots \\
a_{m 1} x_{1}+a_{m 2} x_{2}+\cdots+a_{m n} x_{n}\leq(=,\geq)b_{m}\\
x_1,x_2,...,x_n\geq0&å˜é‡çš„éè´Ÿçº¦æŸæ¡ä»¶
\end{array}\right.
\end{aligned}
$$

#### 3.1 æ ‡å‡†å½¢å¼

ï¼ˆ$M_1$ï¼‰
$$
\begin{aligned}
\max &\space z=c_{1} x_{1}+c_{2} x_{2}+\cdots+c_{n} x_{n}\\
\text { s.t. } &\left\{\begin{array}{l}
a_{11} x_{1}+a_{12} x_{2}+\cdots+a_{1 n} x_{n}=b_{1} \\
a_{21} x_{1}+a_{22} x_{2}+\cdots+a_{2 n} x_{n}=b_{2} \\
\cdots \\
a_{m 1} x_{1}+a_{m 2} x_{2}+\cdots+a_{m n} x_{n}=b_{m}\\

x_1,x_2,...,x_n\geq0
\end{array}\right.
\end{aligned}
$$

  ($M_1^{'}$)
$$
\begin{aligned}
\max &\space z=\sum _{j=1}^n c_{j} x_{j}\\
\text { s.t. } &\left\{\begin{array}{l}
\sum _{j=1}^n a_{ij}x_{j}=b_i\\

x_j\geq0,j=1,2,...,n
\end{array}\right.
\end{aligned}
$$
æ ‡å‡†å½¢å¼ä¸­è§„å®š$ b_{i} > 0 ; i\in(1,2, \cdots, m)$ã€‚å¦åˆ™ç­‰å¼ä¸¤ç«¯ä¹˜ä»¥â€œ-1â€ã€‚

#### 3.2 çŸ©é˜µå½¢å¼

  ($M_1^{''}$)
$$
\begin{aligned}
\max &\space z=CX\\
\text { s.t. } &\left\{\begin{array}{l}
\sum _{j=1}^n P_{j}x_{j}=b\\

x_j\geq0,j=1,2,...,n
\end{array}\right.
\end{aligned}
$$
å…¶ä¸­ï¼š$C=(c_1,c_2,...,c_n)$ï¼Œ$C$â€”â€”â€”ä»·å€¼å‘é‡
$$
X= \left[
\matrix{
  x_1 \\
  x_2 \\
  \cdots\\
  x_n 
}
\right]
P_j = \left[
\matrix{
  a_{1 j}\\
  a_{2 j} \\
  \cdots\\
  a_{m j} 
}
\right]

b= \left[
\matrix{
  b_1 \\
  b_2 \\
  \cdots\\
  b_m
}
\right]
$$
$X$â€”â€”â€”å†³ç­–å˜é‡å‘é‡ï¼Œ$b$â€”â€”â€”èµ„æºå‘é‡

å‘é‡$P_j$å¯¹åº”çš„å†³ç­–å˜é‡ä¸º$x_j$

ç”¨çŸ©é˜µæè¿°æ—¶ä¸ºï¼š
$$
max\space z = CX \\
AX = b \\
X \geq 0
$$

å…¶ä¸­
$$
A = \left[
\matrix{
  a_{11} & a_{12}&\cdots&a_{1n}\\
  \cdots & \cdots&&\cdots\\
  a_{m1} & a_{m2}&\cdots&a_{mn}
}
\right]=(P_1,P_2,\cdots,P_n)
ï¼›0= \left[
\matrix{
  0\\
  0\\
  \cdots\\
  0 
}
\right]
$$
$A$â€”â€”â€”çº¦æŸæ¡ä»¶çš„$mÃ—n$ç»´**ç³»æ•°çŸ©é˜µ**,ä¸€èˆ¬$m<n$

#### 3.3 è½¬åŒ–ä¸ºæ ‡å‡†å½¢å¼

1. ç›®æ ‡å‡½æ•°æ˜¯æ±‚æœ€å°å€¼ $minZ = CX$ï¼Œä»¤ $S = -Z$ åˆ™ $maxS = -CX$
2. çº¦æŸä¸ç­‰å¼ä¸ºå°äºç­‰äºä¸ç­‰å¼ï¼Œå¯ä»¥åœ¨å·¦ç«¯åŠ å…¥éè´Ÿæ¾å¼›å˜é‡(Slack Variable)ï¼Œè½¬å˜ä¸ºç­‰å¼ï¼Œæ¯”å¦‚ï¼š

$$
x_{1}+2 x_{2} \leq 9 \Rightarrow\left\{\begin{array}{c}
x_{1}+2 x_{2}+x_{3}=9 \\
x_{3} \geq 0
\end{array}\right.
$$

3. çº¦æŸä¸ç­‰å¼ä¸ºå¤§äºç­‰äºä¸ç­‰å¼æ—¶ï¼Œå¯ä»¥åœ¨å·¦ç«¯å‡å»ä¸€ä¸ªéè´Ÿæ¾å¼›å˜é‡(Slack Variable)ï¼Œä¹Ÿç§°å‰©ä½™å˜é‡(Surplus Variable)ï¼Œå˜ä¸ºç­‰å¼
4. è‹¥çº¦æŸæ¡ä»¶å³è¾¹çš„æŸä¸€å¸¸æ•° $b_i<0$ï¼Œè¿™æ—¶åªè¦åœ¨ $b_i$ ç›¸å¯¹åº”çš„çº¦æŸæ–¹ç¨‹ä¸¤è¾¹ä¹˜ä¸Š $-1$
5. è‹¥å­˜åœ¨å–å€¼æ— çº¦æŸçš„å˜é‡ï¼Œå¯è½¬å˜ä¸ºä¸¤ä¸ªéè´Ÿå˜é‡çš„å·®ï¼Œæ¯”å¦‚ï¼š

$$
-\infty \leq x_{k} \leq +\infty \Rightarrow\left\{\begin{array}{c}
x_{k}=x_{m}-x_{n} \\
x_{m},x_{n} \geq 0
\end{array}\right.
$$

### 4. æ¦‚å¿µå’Œå‚æ•°è¯´æ˜

#### 4.1 çº¿æ€§è§„åˆ’é—®é¢˜çš„è§£çš„æ¦‚å¿µ

##### 4.1.1 å¯è¡Œè§£

æ»¡è¶³($M_1^{'}$)ä¸­(s.t.)ä¸¤å¼çš„è§£$X=(x_1,x_2,...,x_n)^T$,ç§°ä¸ºçº¿æ€§è§„åˆ’é—®é¢˜çš„å¯è¡Œè§£,å…¶ä¸­ä½¿ç›®æ ‡å‡½æ•°è¾¾åˆ°æœ€å¤§å€¼çš„å¯è¡Œè§£ç§°ä¸º**æœ€ä¼˜è§£**ã€‚

##### 4.1.2 åŸºã€åŸºå‘é‡å’ŒåŸºè§£

$A$ä¸ºçº¦æŸæ¡ä»¶çš„$mÃ—n$ç»´ç³»æ•°çŸ©é˜µ,å…¶ç§©ä¸º$m$ã€‚$B$æ˜¯çŸ©é˜µAä¸­$m\times m$çš„çŸ©é˜µï¼Œå¦‚æœ$B$æ˜¯ç”±$A$ä¸­$m$ä¸ªçº¿æ€§ç‹¬ç«‹çš„åˆ—å‘é‡ç»„æˆï¼Œåˆ™ç§°$B$æ˜¯çº¿æ€§è§„åˆ’é—®é¢˜çš„ä¸€ä¸ªåŸºã€‚

å¯è®¾
$$
B = \left[
\matrix{
  a_{11} & a_{12}&\cdots&a_{1m}\\
  \cdots & \cdots&&\cdots\\
  a_{m1} & a_{m2}&\cdots&a_{mm}
}
\right]=(P_1,P_2,\cdots,P_m)
$$
ç§°$P_j(j=1,2,\cdots,m)$ä¸ºåŸºå‘é‡ï¼Œä¸åŸºå‘é‡$P_j$ç›¸åº”çš„å˜é‡$x_j(j=1,2,...,m)$ä¸ºåŸºå˜é‡ï¼Œå…¶ä»–çš„å†³ç­–å˜é‡ç§°ä¸ºéåŸºå˜é‡ã€‚

ç”±çº¦æŸæ¡ä»¶ç»„å¯å¾—æ–¹ç¨‹ç»„ï¼š
$$
\sum _{j=1}^m P_{j} x_{j}=b-\sum _{j=m+1}^n P_{j} x_{j}
$$
Bæ˜¯è¿™ä¸ªæ–¹ç¨‹ç»„çš„ä¸€ä¸ªåŸºï¼Œè®¾$X_B$æ˜¯å¯¹åº”äºè¿™ä¸ªåŸºçš„åŸºå˜é‡$X_B=(x_1,x_2,,,x_m)^T$

è‹¥å¦éåŸºå˜é‡$x_{m+1},x_{m+2},...,x_{n}=0$,è¿™æ—¶å˜é‡çš„ä¸ªæ•°ç­‰äºçº¿æ€§æ–¹ç¨‹çš„ä¸ªæ•°ï¼Œ

åˆ©ç”¨é«˜æ–¯æ¶ˆå»æ³•å¯æ±‚å‡ºä¸€ä¸ªè§£
$$
X=(x_1,x_2...,x_m,0,...,0)^T
$$
è¯¥è§£çš„éé›¶åˆ†é‡çš„æ•°ç›®ä¸å¤§äºæ–¹ç¨‹ä¸ªæ•°$m$,ç§°$X$ä¸º**åŸºè§£**ã€‚(æœ‰ä¸€ä¸ªåŸºï¼Œå°±å¯ä»¥æ±‚å‡ºä¸€ä¸ªåŸºè§£)

çº¦æŸæ–¹ç¨‹ç»„(1-5)å…·æœ‰åŸºè§£çš„æ•°ç›®æœ€å¤šæ˜¯$C_n^m$ä¸ª

##### 4.1.3 åŸºå¯è¡Œè§£

æ»¡è¶³**éè´Ÿæ¡ä»¶**çš„åŸºè§£

##### 4.1.4 å¯è¡ŒåŸº

å¯¹åº”äºåŸºå¯è¡Œè§£çš„åŸºã€‚

#### 4.2 å•çº¯å½¢è¡¨

å°†æ–¹ç¨‹ç»„
$$
\begin{aligned} &(1-23)\left\{\begin{array}{l}x_{1}\space \space \space \space \space \space \space \space+a_{1,m+1} x_{m+1}+\cdots+a_{1 n} x_{n}=b_{1} \\\space \space \space \space x_{2}\space \space \space \space +a_{2,m+1} x_{m+1}+\cdots+a_{2 n} x_{n}=b_{2} \\\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\cdots \\\space \space\space \space \space \space \space x_{m}+a_{m,m+1} x_{m+1}+\cdots+a_{m n} x_{n}=b_{m}\\â€‹\space \space \space \\\space \space \space -z+c_1x_1+c_2x_2+â€¦+c_nx_n=0\end{array}\right.\end{aligned}
$$
å†™æˆå¢å¹¿çŸ©é˜µ
$$
\left[\begin{array}{cccccccc|c}-z & x_{1} & x_{2} & \cdots & x_{m} & x_{m+1} & \cdots & x_{n} & b \\ 0 & 1 & 0 & \cdots & 0 & a_{1, m+1} & \cdots & a_{1n} & b_1 \\ 0 & 0 & 1 & \cdots & 0 & a_{2.m+1} & \cdots & a_{2n} & b_{2} \\ \cdots & & & & & & & \\ 0 & 0 & 0 & \cdots & 1 & a_{m, m+1} & \cdots & a_{m n} & b_{m} \\ 1 & c_1 & c_2 & \cdots & c_{m} & c_{m+1} & \cdots & c_{n} & 0\end{array}\right]
$$
å°†$z$çœ‹ä½œä¸å‚ä¸åŸºå˜æ¢çš„åŸºå˜é‡,å®ƒä¸$x_1,x_2,â€¦,x_m$çš„ç³»æ•°æ„æˆä¸€ä¸ªåŸº,è¿™æ—¶å¯é‡‡ç”¨è¡Œåˆç­‰å˜æ¢å°†$c_1,c_2,â€¦,c_m$å˜æ¢ä¸ºé›¶,ä½¿å…¶å¯¹åº”çš„ç³»æ•°çŸ©é˜µä¸ºå•ä½çŸ©é˜µã€‚å¾—åˆ°
$$
\left[\begin{array}{cccccccc|c}-z & x_{1} & x_{2} & \cdots & x_{m} & x_{m+1} & \cdots & x_{n} & b \\ 0 & 1 & 0 & \cdots & 0 & a_{1, m+1} & \cdots & a_{1 n} & b_1 \\ 0 & 0 & 1 & \cdots & 0 & a_{2, m+1} & \cdots & a_{2 n} & b_2 \\ \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \\ 0 & 0 & 0 & \cdots & 1 &  a_{m, m+1} & \cdots & a_{m n} & b_{m} \\ 1 & 0 & 0 & \cdots & 0 & c_{m+1}  -\sum_{i=1}^m c_{i} a_{i, m+1} & \cdots & c_{n}-\sum_{i=1}^m c_{i} a_{i,n} & -\sum_{i=1}^{m} c_i b_{i}\end{array}\right]
$$
å¯æ ¹æ®ä¸Šè¿°å¢å¹¿çŸ©é˜µè®¾è®¡è®¡ç®—è¡¨ï¼Œè§è¡¨1-2ã€‚

~~~latex
\begin{tabular}{c|c|c|c|c|c|c|c|c|c}
\hline 
\multicolumn{3}{c|}{$c_{j} \rightarrow$} & $c_1$ & $\ldots$ & $c_{m}$ & $c_{m+1}$ & $\ldots$ & $c_{n}$ &  \multirow{2}{c|}{$\theta_{i}$ }\\
\hline
$C_{B}$ & $X_{B}$ & $b$ & $x_{1}$ & $\cdots$ & $x_{m}$ & $x_{m+1}$ & $\cdots$ & $x_{n}$  \\
\hline$c_{1}$ & $x_{1}$ & $b_1$ & 1 & $\cdots$ & 0 & $a_{1, m+1}$ & $\cdots$ & $a_{1,n}$ & $\theta_{1}$ \\
$c_{2}$ & $x_{2}$ & $b_2$ & 0 & $\cdots$ & 0 & $a_{2, m+1}$ &$\cdots$ &  $a_{2,n}$ & $\theta_{2}$ \\
$\ldots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ &$\cdots$&  \\
$c_{m}$ & $x_{m}$ & $b_{m}$ & 0 & $\cdots$ & 1 & $a_{m, m+1}$ & $\cdots$ & $a_{m,n}$& $\theta_m$\\
\hline
\multicolumn{2}{c|}{$-z$ }& $-\sum_{i=1}^{m} c_{i} b_{i}$ & 0 & $\cdots$ & 0 & $c_{m+1}-\sum_{i=1}^{m} c_{i} a_{i, m+1}$ & $\cdots$ & $c_{n}-\sum_{i=1}^{m} c_{i} a_{i,n}$ \\
\hline
\end{tabular}

~~~

![è¡¨1-2](C:\Users\Lenovo\Desktop\è¡¨1-2.png)

$X_B$åˆ—ä¸­å¡«å…¥åŸºå˜é‡,è¿™é‡Œæ˜¯$x_1,x_2,â€¦,x_m$;

$C_B$åˆ—ä¸­å¡«å…¥åŸºå˜é‡çš„ä»·å€¼ç³»æ•°,è¿™é‡Œæ˜¯$c_1,c_2,â€¦,c_m$;å®ƒä»¬æ˜¯ä¸åŸºå˜é‡ç›¸å¯¹åº”çš„;

$b$åˆ—ä¸­å¡«å…¥çº¦æŸæ–¹ç¨‹ç»„å³ç«¯çš„å¸¸æ•°;

$c_j$è¡Œä¸­å¡«å…¥åŸºå˜é‡çš„ä»·å€¼ç³»æ•°$c_1,c_2,â€¦,c_n$;

$Î¸_i$åˆ—çš„æ•°å­—æ˜¯åœ¨ç¡®å®šæ¢å…¥å˜é‡å,æŒ‰$Î¸$è§„åˆ™è®¡ç®—åå¡«å…¥;

æœ€åä¸€è¡Œç§°ä¸ºæ£€éªŒæ•°è¡Œ,å¯¹åº”å„éåŸºå˜é‡$x_j$çš„æ£€éªŒæ•°æ˜¯
$$
c_j-\sum _{i=1}^mc_ia_{ij}, j=1,2,â€¦,n
$$
è¡¨1-2ç§°ä¸ºåˆå§‹å•çº¯å½¢è¡¨,æ¯è¿­ä»£ä¸€æ­¥æ„é€ ä¸€ä¸ªæ–°å•çº¯å½¢è¡¨ã€‚

#### 4.3 å•çº¯å½¢æ³•çš„çŸ©é˜µæè¿°

![22222](C:\Users\Lenovo\Desktop\22222.png)

ç›®æ ‡å‡½æ•°
$$
max\space z=C_BX_B+C_NX_N=C_BX_B+C_{N1}X_{N1}+C_{S2}X_{S2}
$$
çº¦æŸæ¡ä»¶
$$
BX_B+NX_N=BX_B+N_1X_{N1}+S_2X_{S2}=b
$$
éè´Ÿæ¡ä»¶
$$
X_B,X_N\ge0
$$
$X_B=B^{-1}b-B^{-1}N_1X_{N1}-B^{-1}S_2X_{S2}$          (2-4)

æ•´ç†å¾—($S_2$å•ä½çŸ©é˜µ)ï¼š(2-5)
$$
z=C_BB^{-1}b+(C_{N1}-C_BB^{-1}N_1)X_{N1}+(C_{S2}-C_BB^{-1}I)X_{S2}
$$
ä»¤éåŸºå˜é‡$X_N=0$,å¾—åˆ°ä¸€ä¸ªåŸºå¯è¡Œè§£
$$
X^{(1)}=\left[
\matrix{
 B^{-1}b\\
  0 
}
\right]
$$
è¿™æ—¶ç›®æ ‡å‡½æ•°$z=C_BB^{-1}b$

(1)éåŸºå˜é‡çš„ç³»æ•°$(C_{N1}-C_BB^{-1}N_1)$å°±æ˜¯æ£€éªŒæ•°ï¼Œå› ä¸º$C_{S2}=0$,$I$ä¸ºå•ä½çŸ©é˜µï¼Œæ‰€ä»¥$X_{S2}$çš„ç³»æ•°ä¸º$-C_BB^{-1}$,

$X_B$åœ¨(2-5)ä¸­çš„ç³»æ•°æ˜¯0ï¼Œå®è´¨æ˜¯$C_B-C_BB^{-1}B=0$

(2)ç”¨çŸ©é˜µè¡¨è¾¾æ—¶ï¼Œ$\theta$è§„åˆ™çš„è¡¨è¾¾å¼
$$
\theta=min[\frac{(B^{-1}b)_i}{(B^{-1}P_j)_i}|(B^{-1}P_j)_i>0]
$$
è¿™é‡Œçš„$(B^{-1}b)_i$è¡¨ç¤º$(B^{-1}b)$ä¸­çš„ç¬¬iä¸ªå…ƒç´ ,$(B^{-1}P_j)_i$è¡¨ç¤ºå‘é‡$(B^{-1}P_j)$ä¸­çš„ç¬¬iä¸ªå…ƒç´ ã€‚

(3)å•çº¯å½¢è¡¨ä¸çŸ©é˜µè¡¨ç¤ºçš„å…³ç³»

![11111111](C:\Users\Lenovo\Desktop\11111111.png)

![5555](C:\Users\Lenovo\Desktop\5555.jpg)

### 5. æ±‚è§£æ–¹æ³•

#### 4.1 å›¾è§£æ³•(Graphical Solution)

##### 4.1.1 æ­¥éª¤

1. ç¡®å®šçº¦æŸåŒºåŸŸ

2. ç”»å‡ºç›®æ ‡å‡½æ•°ç­‰å€¼çº¿ï¼Œå¹³ç§»ç›®æ ‡å‡½æ•°ç­‰å€¼çº¿æ±‚æœ€ä¼˜è§£

<img src="/Users/xinyuanhe/Desktop/2021ç¾èµ›/æ¨¡å‹/æ¨¡å‹-è¿ç­¹å­¦-è§„åˆ’è®º-çº¿æ€§è§„åˆ’ã€hxyã€‘/å›¾è§£æ³•.png" alt="å›¾è§£æ³•" style="zoom:67%;" />

#### 4.2 å•çº¯å½¢æ–¹æ³•(Simplex Method)

##### 4.2.1 åŸºæœ¬æ€è·¯

> å•çº¯å½¢æ³•æ˜¯ä»ä¸€ä¸ªåˆå§‹è§£å¼€å§‹, ä¸æ–­åœ°æ”¹è¿›ç°æœ‰çš„è§£, ç›´åˆ°æ‰€è¦æ±‚çš„ç›®æ ‡å‡½æ•°å€¼è¢«æ»¡è¶³ä¸ºæ­¢ã€‚å³æ˜¯è¿›è¡Œåå¤çš„è¿­ä»£, ç›´åˆ°å¾—åˆ°éœ€è¦çš„æœ€ä¼˜è§£ã€‚
>
> (å•çº¯å½¢æ³•å°±æ˜¯é€šè¿‡è®¾ç½®ä¸åŒçš„åŸºå‘é‡ï¼Œç»è¿‡çŸ©é˜µçš„çº¿æ€§å˜æ¢ï¼Œæ±‚å¾—åŸºå¯è¡Œè§£ï¼ˆå¯è¡ŒåŸŸé¡¶ç‚¹ï¼‰ï¼Œå¹¶åˆ¤æ–­è¯¥è§£æ˜¯å¦æœ€ä¼˜ï¼Œå¦åˆ™ç»§ç»­è®¾ç½®å¦ä¸€ç»„åŸºå‘é‡ï¼Œé‡å¤æ‰§è¡Œä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¼˜è§£ã€‚)

##### 4.2.2 æ­¥éª¤

------------------------------------------------------------------------------------------------------------------------------------------------------

1. **æ‰¾å‡ºåˆå§‹å¯è¡ŒåŸº,ç¡®å®šåˆå§‹åŸºå¯è¡Œè§£,å»ºç«‹åˆå§‹å•çº¯å½¢è¡¨**ã€‚

------------------------------------------------------------------------------------------------------------------------------------------------------

######  4.2.2.1 åˆå§‹åŸºå¯è¡Œè§£çš„ç¡®å®š

(1)è‹¥çº¿æ€§è§„åˆ’é—®é¢˜
$$
max\space z=\sum _{j=1}^n c_{j}x_{j}\\
\sum _{j=1}^n P_{j}x_{j}=b\\
x_j\geq0,j=1,2,...,n
$$
ä»$P_j(j=1,2,...,n)$ä¸­ä¸€èˆ¬èƒ½ç›´æ¥è§‚å¯Ÿåˆ°ä¸€ä¸ªåˆå§‹å¯è¡ŒåŸº
$$
B=(P_1,P_2,...,P_m)=\left[
\matrix{
 1 & 0&\cdots&0\\
  0 &1& \cdots&0\\
   \cdots& \cdots& \cdots& \cdots\\
  0 & 0&\cdots&1
}
\right]
$$
(2)å¯¹æ‰€æœ‰çº¦æŸæ¡ä»¶éƒ½æ˜¯$\leq$çš„ä¸ç­‰å¼ï¼Œå¯ä»¥åˆ©ç”¨åŒ–ä¸ºæ ‡å‡†å‹çš„æ–¹æ³•,åœ¨æ¯ä¸ªçº¦æŸæ¡ä»¶çš„å·¦ç«¯åŠ ä¸Šä¸€ä¸ªæ¾å¼›å˜é‡ã€‚ç»è¿‡æ•´ç†,é‡æ–°å¯¹$x_j$åŠ$a_{ij}(i=1,2,â€¦,m;j=1,2,â€¦,n)$è¿›è¡Œç¼–å·,åˆ™å¯å¾—ä¸‹åˆ—æ–¹ç¨‹ç»„
$$
\begin{aligned}
 &(1-23)\left\{\begin{array}{l}
x_{1}\space \space \space \space \space \space \space \space+a_{1,m+1} x_{m+1}+\cdots+a_{1 n} x_{n}=b_{1} \\
\space \space \space \space x_{2}\space \space \space \space +a_{2,m+1} x_{m+1}+\cdots+a_{2 n} x_{n}=b_{2} \\
\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\cdots \\
\space \space\space \space \space \space \space x_{m}+a_{m,m+1} x_{m+1}+\cdots+a_{m n} x_{n}=b_{m}\\

\space \space \space \space \space \space \space \space \space \space \space \space \space \space \space \space x_1,x_2,...,x_n\geq0
\end{array}\right.
\end{aligned}
$$
æ˜¾ç„¶å¾—åˆ°ä¸€ä¸ª$m\times m $å•ä½çŸ©é˜µ
$$
B=(P_1,P_2,...,P_m)=\left[
\matrix{
 1 & 0&\cdots&0\\
  0 &1& \cdots&0\\
   \cdots& \cdots& \cdots& \cdots\\
  0 & 0&\cdots&1
}
\right]
$$
ä»¤$x_{m+1},x_{m+2},...,x_{n}=0$,å¯å¾—
$$
x_i=b_i\space \space(i=1,2,...,m)
$$
å› $b_i\geq0$,æ‰€ä»¥å¾—åˆ°ä¸€ä¸ªåˆå§‹åŸºå¯è¡Œè§£
$$
X=(x_1,x_2,...,x_m,0,...,0)^T=(b_1,b_2,...,b_m,0,...,0)^T
$$

(3)å¯¹æ‰€æœ‰çº¦æŸæ¡ä»¶æ˜¯$â‰¥$å½¢å¼çš„ä¸ç­‰å¼åŠç­‰å¼çº¦æŸæƒ…å†µ,è‹¥ä¸å­˜åœ¨å•ä½çŸ©é˜µæ—¶,å°±é‡‡ç”¨äººé€ åŸºæ–¹æ³•ã€‚å³å¯¹ä¸ç­‰å¼çº¦æŸå‡å»ä¸€ä¸ªéè´Ÿçš„å‰©ä½™å˜é‡å,å†åŠ ä¸Šä¸€ä¸ªéè´Ÿçš„äººå·¥å˜é‡;å¯¹äºç­‰å¼çº¦æŸå†åŠ ä¸Šä¸€ä¸ªéè´Ÿçš„äººå·¥å˜é‡,æ€»èƒ½å¾—åˆ°ä¸€ä¸ªå•ä½çŸ©é˜µã€‚

------------------------------------------------------------------------------------------------------------------------------------------------------

2. **æ£€éªŒå„éåŸºå˜é‡$x_j$çš„æ£€éªŒæ•°æ˜¯**
   $$
   \sigma_j=c_j-\sum_{i=1}^mc_ia_{ij}ï¼Œ\space è‹¥\sigma_j\le 0ï¼Œ\space j=m+1,...,n
   $$
   **åˆ™å·²å¾—åˆ°æœ€ä¼˜è§£,å¯åœæ­¢è®¡ç®—ã€‚å¦åˆ™è½¬å…¥ä¸‹ä¸€æ­¥**ã€‚

------------------------------------------------------------------------------------------------------------------------------------------------------

###### 4.2.2.2 æœ€ä¼˜æ€§æ£€éªŒä¸è§£çš„åˆ¤åˆ«

å¯¹çº¿æ€§è§„åˆ’é—®é¢˜çš„æ±‚è§£ç»“æœå¯èƒ½å‡ºç°å”¯ä¸€æœ€ä¼˜è§£ã€æ— ç©·å¤šæœ€ä¼˜è§£ã€æ— ç•Œè§£å’Œæ— å¯è¡Œè§£å››ç§æƒ…å†µ,ä¸ºæ­¤éœ€è¦å»ºç«‹å¯¹è§£çš„åˆ¤åˆ«å‡†åˆ™ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹,ç»è¿‡è¿­ä»£å(1-23)å¼å˜æˆ
$$
x_i=b_i^{'}-\sum_{j=m+1}^n a_{ij}^{'}x_j\space (i=1,2,...,m)
$$
æŠŠç›®æ ‡å‡½æ•°zç”¨éåŸºå˜é‡è¡¨ç¤º
$$
z=\sum_{i=1}^m c_{i}b_i^{'}+\sum_{j=m+1}^n (c_{j}-\sum_{i=1}^mc_ia_{ij}^{'})x_j
$$
ä»¤
$$
z_0=\sum_{i=1}^mc_ib_i^{'},z_j=\sum_{i=1}^mc_ia_{ij}^{'},j=m+1,...,n
$$
äºæ˜¯
$$
z=z_0+\sum_{j=m+1}^n(c_j-z_j)x_j
$$
å†ä»¤
$$
\sigma_j=c_j-z_j\space(j=m+1,...,n)
$$
åˆ™
$$
z=z_0+\sum_{j=m+1}^n\sigma_jx_j
$$

1. æœ€ä¼˜è§£çš„åˆ¤åˆ«å®šç†

   è‹¥$X^{(0)}=(b_1^{'},b_2^{'},...,b_m^{'},0,...,0)^T$ä¸ºå¯¹åº”åŸºBçš„ä¸€ä¸ªåŸºå¯è¡Œè§£ï¼Œä¸”å¯¹äºæ‰€æœ‰$j=m+1,...,n$ï¼Œæœ‰$\sigma_j\le0$,åˆ™$X^{(0)}$ä¸ºæœ€ä¼˜è§£ï¼Œç§°$\sigma_j$ä¸ºæ£€éªŒæ•°

2. æ— ç©·å¤šæœ€ä¼˜è§£åˆ¤åˆ«å®šç†

   è‹¥$X^{(0)}=(b_1^{'},b_2^{'},...,b_m^{'},0,...,0)^T$ä¸ºä¸€ä¸ªåŸºå¯è¡Œè§£ï¼Œå¯¹äºæ‰€æœ‰$j=m+1,...,n$ï¼Œæœ‰$\sigma_j\le0$,ä¸”å­˜åœ¨æŸä¸ªéåŸºå˜é‡çš„æ£€éªŒæ•°$\sigma_{m+k}=0$ï¼Œåˆ™çº¿æ€§è§„åˆ’é—®é¢˜æœ‰æ— ç©·å¤šå¯è¡Œè§£

3. æ— ç•Œè§£åˆ¤åˆ«å®šç†

   è‹¥$X^{(0)}=(b_1^{'},b_2^{'},...,b_m^{'},0,...,0)^T$ä¸ºä¸€ä¸ªåŸºå¯è¡Œè§£ï¼Œæœ‰ä¸€ä¸ª$\sigma_{m+k}>0$,å¹¶ä¸”å¯¹äº$i=1,2,...,m$,æœ‰

$a_{1,m+k}\le0$(å¯¹åº”çš„ç³»æ•°åˆ—)ï¼Œé‚£ä¹ˆè¯¥çº¿æ€§è§„åˆ’é—®é¢˜å…·æœ‰æ— ç•Œè§£(æˆ–ç§°æ— æœ€ä¼˜è§£)ã€‚



ä»¥ä¸Šè®¨è®ºéƒ½æ˜¯**é’ˆå¯¹æ ‡å‡†å‹**,å³**æ±‚ç›®æ ‡å‡½æ•°æå¤§åŒ–**æ—¶çš„æƒ…å†µã€‚å½“æ±‚ç›®æ ‡å‡½æ•°æå°åŒ–æ—¶,ä¸€ç§æƒ…å†µå¦‚å‰æ‰€è¿°,å°†å…¶åŒ–ä¸ºæ ‡å‡†å‹ã€‚å¦‚æœä¸åŒ–ä¸ºæ ‡å‡†å‹,åªéœ€åœ¨ä¸Šè¿°1,2ç‚¹ä¸­æŠŠ$Ïƒ_jâ‰¤0$æ”¹ä¸º$Ïƒ_jâ‰¥0$,ç¬¬3ç‚¹ä¸­å°†$Ïƒ_{m+k}>0$æ”¹å†™ä¸º$Ïƒ_{m+k}<0$å³å¯ã€‚

------------------------------------------------------------------------------------------------------------------------------------------------------

3. **åœ¨$Ïƒ_j>0,j=m+1,â€¦,n$ä¸­,è‹¥æœ‰æŸä¸ª$Ïƒ_k$å¯¹åº”$x_k$çš„ç³»æ•°åˆ—å‘é‡$P_kâ‰¤0$,åˆ™æ­¤é—®é¢˜æ˜¯æ— ç•Œ,åœæ­¢è®¡ç®—ã€‚å¦åˆ™,è½¬å…¥ä¸‹ä¸€æ­¥**ã€‚

------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------

4. **æ ¹æ®$\max(Ïƒ_j>0)=Ïƒ_k$,ç¡®å®š$x_k$ä¸ºæ¢å…¥å˜é‡,æŒ‰Î¸è§„åˆ™è®¡ç®—**
   $$
   \theta=min(\frac{b_i}{a_{i,k}}|a_{i,k}>0)=\frac{b_l}{a_{lk}}ï¼Œ\space i=1,2,...,m
   $$
   **å¯ç¡®å®š$x_l$ä¸ºæ¢å‡ºå˜é‡,è½¬å…¥ä¸‹ä¸€æ­¥ã€‚**

------------------------------------------------------------------------------------------------------------------------------------------------------

###### 4.2.2.3 åŸºå˜æ¢

(ä»ä¸€ä¸ªåŸºå¯è¡Œè§£åˆ°å¦ä¸€ä¸ªåŸºå¯è¡Œè§£çš„å˜æ¢,å°±æ˜¯è¿›è¡Œä¸€æ¬¡åŸºå˜æ¢ã€‚ä»å‡ ä½•æ„ä¹‰ä¸Šè®²,å°±æ˜¯ä»å¯è¡ŒåŸŸçš„ä¸€ä¸ªé¡¶ç‚¹è½¬å‘å¦ä¸€ä¸ªé¡¶ç‚¹)

è‹¥åˆå§‹åŸºå¯è¡Œè§£$X^{(0)}$ä¸æ˜¯æœ€ä¼˜è§£åŠä¸èƒ½åˆ¤åˆ«æ— ç•Œæ—¶,éœ€è¦æ‰¾ä¸€ä¸ªæ–°çš„åŸºå¯è¡Œè§£ã€‚å…·ä½“åšæ³•æ˜¯ä»åŸå¯è¡Œè§£åŸºä¸­æ¢ä¸€ä¸ªåˆ—å‘é‡(å½“ç„¶è¦ä¿è¯çº¿æ€§ç‹¬ç«‹),å¾—åˆ°ä¸€ä¸ªæ–°çš„å¯è¡ŒåŸº,è¿™ç§°ä¸ºåŸºå˜æ¢ã€‚ä¸ºäº†æ¢åŸº,å…ˆè¦ç¡®å®šæ¢å…¥å˜é‡,å†ç¡®å®šæ¢å‡ºå˜é‡,è®©å®ƒä»¬ç›¸åº”çš„ç³»æ•°åˆ—å‘é‡è¿›è¡Œå¯¹æ¢,å°±å¾—åˆ°ä¸€ä¸ªæ–°çš„åŸºå¯è¡Œè§£ã€‚

1. æ¢å…¥å˜é‡çš„ç¡®å®š

   å½“æŸäº›$Ïƒ_j>0$æ—¶,$x_j$å¢åŠ åˆ™ç›®æ ‡å‡½æ•°å€¼è¿˜å¯ä»¥å¢å¤§,è¿™æ—¶è¦å°†æŸä¸ªéåŸºå˜é‡$x_j$æ¢åˆ°åŸºå˜é‡ä¸­å»(ç§°ä¸ºæ¢å…¥å˜é‡)ã€‚è‹¥æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„$Ïƒ_j$>0,ä¸ºäº†ä½¿ç›®æ ‡å‡½æ•°å€¼å¢åŠ å¾—å¿«,ä¸€èˆ¬é€‰$Ïƒ_j>0$ä¸­çš„å¤§è€…,å³$\max_ j(Ïƒ_j>0)=Ïƒ_k$åˆ™å¯¹åº”çš„xkä¸ºæ¢å…¥å˜é‡ã€‚

2. æ¢å‡ºå˜é‡çš„ç¡®å®š

   è®¾$P_1,P_2,...,P_m$æ˜¯ä¸€ç»„çº¿æ€§ç‹¬ç«‹çš„å‘é‡ç»„ï¼Œå¯¹åº”åŸºå¯è¡Œè§£$X^{(0)}$ï¼Œå¸¦å…¥çº¦æŸæ–¹ç¨‹ç»„æœ‰
   $$
   \sum_{i=1}^m x_i^{(0)}P_i=b
   $$
   å…¶ä»–éåŸºå˜é‡çš„åˆ—å‘é‡å¯ä»¥ç”¨$P_1,P_2,...,P_m$çº¿æ€§è¡¨ç¤ºï¼Œè‹¥ç¡®å®š$P_{m+t}$ä¸ºæ¢å…¥å˜é‡ï¼Œå¿…ç„¶æœ‰ä¸€ç»„ä¸å…¨ä¸º0çš„æ•°ä½¿å¾—
   $$
   P_{m+t}=\sum _{i=1}^m \beta_{i,m+t}P_i
   $$
   åœ¨ä¸Šå¼ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥æ­£æ•°$\theta$,å†åŠ åˆ°ä¸Šä¸Šå¼ä¸­ï¼Œå¾—
   $$
   \sum_{i=1}^m (x_i^{(0)}-\theta\beta_{i,m+t})P_i+\theta P_{m+t}=b
   $$
   $\theta$å–$\frac{x_i^{(0)}}{\beta_{i,m+t}}$ä¸­å¤§äºé›¶çš„ä¸”æœ€å°çš„æ•°ã€‚è®¾$x_l$ä¸ºæ¢å‡ºå˜é‡($l$åœ¨1~mä¹‹é—´)ã€‚å°†è¿™ä¸ª$\theta=\frac{x_i^{(0)}}{\beta_{i,m+t}}$ä»£å…¥Xä¸­ï¼Œå¾—åˆ°æ–°çš„åŸºå¯è¡Œè§£
   $$
   X^{(1)}=[x_1^{(0)}-\theta\beta_{1,m+t},...,0,...,x_m^{(0)}-\theta\beta_{m,m+t},0,...,\frac{x_l^{(0)}}{\beta_{l,m+t}},...,0]
   $$

------------------------------------------------------------------------------------------------------------------------------------------------------

5. **ä»¥$a_{lk}$ä¸ºä¸»å…ƒç´ è¿›è¡Œè¿­ä»£(å³ç”¨é«˜æ–¯æ¶ˆå»æ³•æˆ–ç§°ä¸ºæ—‹è½¬è¿ç®—),æŠŠ$x_k$æ‰€å¯¹åº”çš„åˆ—å‘é‡$P_k$è½¬å˜ä¸º$P_l$**
   $$
   P_k= \left[
   \matrix{
     a_{1k} \\
     a_{2k}\\
     \cdots\\
     a_{lk}\\
      \cdots\\
     a_{mk} 
   }
   \right]
   P_l = \left[
   \matrix{
     0 \\
     
     \cdots\\
     1\\
     0\\
      \cdots\\
     0 
   }
   \right]
   $$
   **å°†$X_B$åˆ—ä¸­çš„$x_l$æ¢ä¸º$x_k$,å¾—åˆ°æ–°çš„å•çº¯å½¢è¡¨ã€‚é‡å¤(2)ï½(5),ç›´åˆ°ç»ˆæ­¢ã€‚**

------------------------------------------------------------------------------------------------------------------------------------------------------

###### 4.2.2.4 è¿­ä»£(æ—‹è½¬è¿ç®—)

 ä¸Šè¿°è®¨è®ºçš„åŸºå¯è¡Œè§£çš„è½¬æ¢æ–¹æ³•æ˜¯ç”¨**å‘é‡æ–¹ç¨‹**æ¥æè¿°,åœ¨å®é™…è®¡ç®—æ—¶ä¸å¤ªæ–¹ä¾¿,å› æ­¤é‡‡ç”¨**ç³»æ•°çŸ©é˜µæ³•**ã€‚

çº¦æŸæ–¹ç¨‹ç»„ç»è¿‡å¤„ç†å¾ˆå®¹æ˜“å¾—åˆ°
$$
\begin{aligned} &(1-23)\left\{\begin{array}{l}x_{1}\space \space \space \space \space \space \space \space+a_{1,m+1} x_{m+1}+\cdots+a_{1 n} x_{n}=b_{1} \\\space \space \space \space x_{2}\space \space \space \space +a_{2,m+1} x_{m+1}+\cdots+a_{2 n} x_{n}=b_{2} \\\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\space \space \space \space \space \space \space \space\cdots \\\space \space\space \space \space \space \space x_{m}+a_{m,m+1} x_{m+1}+\cdots+a_{m n} x_{n}=b_{m}\\â€‹\space \space \space \space \space \space \space \space \space \space \space \space \space \space \space \space x_1,x_2,...,x_n\geq0\end{array}\right.\end{aligned}
$$
å…¶ä¸­$x_1,x_2,...,x_m$ä¸ºåŸºå˜é‡ï¼Œä»¤å…¶ä»–éåŸºå˜é‡ç­‰äºé›¶ï¼Œå¯å¾—åˆ°ä¸€ä¸ªåŸºå¯è¡Œè§£ã€‚è‹¥å®ƒä¸æ˜¯æœ€ä¼˜è§£,åˆ™è¦å¦æ‰¾ä¸€ä¸ªä½¿ç›®æ ‡å‡½æ•°å€¼å¢å¤§çš„åŸºå¯è¡Œè§£ã€‚è¿™æ—¶ä»éåŸºå˜é‡ä¸­ç¡®å®š$x_k$ä¸ºæ¢å…¥å˜é‡ã€‚è¿™æ—¶$\theta$ä¸º
$$
\theta=min(\frac{b_i}{a_{i,k}}|a_{i,k}>0),i=1,2,...,m
$$
æŒ‰$\theta$è§„åˆ™ç¡®å®š$x_l$ä¸ºæ¢å‡ºå˜é‡ï¼Œ$x_k,x_l$çš„ç³»æ•°åˆ—å‘é‡åˆ†åˆ«ä¸º
$$
P_k= \left[
\matrix{
  a_{1k} \\
  a_{2k}\\
  \cdots\\
  a_{lk}\\
   \cdots\\
  a_{mk} 
}
\right]
P_l = \left[
\matrix{
  0 \\
  
  \cdots\\
  1\\
  0\\
   \cdots\\
  0 
}
\right]
$$
ä¸ºäº†ä½¿$x_k$ä¸$x_l$è¿›è¡Œå¯¹æ¢,é¡»æŠŠ$P_k$å˜ä¸ºå•ä½å‘é‡,è¿™å¯ä»¥é€šè¿‡(1-23)å¼ç³»æ•°çŸ©é˜µçš„å¢å¹¿çŸ©é˜µè¿›è¡Œåˆç­‰å˜æ¢æ¥å®ç°ã€‚
$$
\begin{array}{ccc}
x_{1} \cdots x_{l}  \cdots x_{m}\space \space \space \space \space & x_{m+1} \cdots x_{k} \cdots  x_{n} &\space\space\space\space\space b 
\end{array}
$$

$$
\left[\begin{array}{cc|c}
1 \cdots\cdots\cdots0 & a_{1, m+1} \cdots a_{1,k} \cdots a_{1 n} & b_1 \\
\cdots & \cdots & \cdots \\
0\cdots 1 \cdots0 & a_{l, m+1} \cdots a_{l,k}\cdots  a_{l n} & b_{l}\\
\cdots & \cdots &  \cdots \\
 0\cdots\cdots \cdots1 & a_{m, m+1} \cdots a_{m,k}  \cdots a_{m n} & b_{m}
\end{array}\right]
$$

æ­¥éª¤

(1)å°†å¢å¹¿çŸ©é˜µï¼ˆ1-34ï¼‰ç¬¬$l$è¡Œé™¤ä»¥$a_{lk}$,å¾—åˆ°
$$
[0,...,0,\frac{1}{a_{lk}},0,...,0,\frac{a_{l,m+1}}{a_{l,k}},...,1,...,\frac{a_{ln}}{a_{lk}}|\frac{b_l}{a_{lk}}]\space (1-35)
$$
(2)å°†(1-34)ä¸­$x_k$åˆ—ä¸­å„å…ƒç´ ï¼Œé™¤$a_{lk}$å˜æ¢ä¸º1ä»¥å¤–ï¼Œå…¶ä»–éƒ½å˜æ¢ä¸º0ã€‚

å°†(1-35)å¼ä¹˜ä»¥$a_{ik}(i\neq l)$åï¼Œä»(1-34)å¼å­çš„ç¬¬$i$è¡Œå‡å»ï¼Œå¾—åˆ°æ–°çš„ç¬¬$i$è¡Œ

(3)ç»è¿‡åˆç­‰å˜æ¢åçš„æ–°å¢å¹¿çŸ©é˜µæ˜¯(1-36)
$$
\begin{array}{ccc}
x_{1} \cdots x_{l} \cdots x_{m}& x_{m+1} \cdots x_{k} \cdots  x_{n} & b 
\end{array}
$$

$$
\left[\begin{array}{cc|c}
1 \cdots-\frac{a_{1 k}}{a_{l k}} \cdots 0 & a_{1, m+1}^{\prime} \cdots 0 \cdots a_{1 n}^{\prime} & b_{1 n}^{\prime} \\
\cdots & \cdots & \cdots \\
0 \cdots +\frac{1}{a_{1 k}} \cdots 0 & a_{l, m+1}^{\prime} \cdots 1 \cdots  a_{l n}^{\prime} & b_{l}^{\prime} \\
\cdots & \cdots &  \cdots \\
0 \cdots-\frac{a_{m k}}{a_{l k}} \cdots 1 & a_{m, m+1} ^{\prime} \cdots 0  \cdots a_{m n}^{\prime} & b_{m}^{\prime}
\end{array}\right]
$$

(4)éåŸºå˜é‡ä¸º0ï¼Œå¾—åˆ°ä¸€ä¸ªåŸºå¯è¡Œè§£
$$
X^{(1)}=(b_1^{'},...,0,...,b_m^{'},0,...,b_k^{'},0,...,0)
$$

##### 4.2.3 å®ä¾‹ 

æŸå·¥å‚åœ¨è®¡åˆ’æœŸå†…è¦å®‰æ’ç”Ÿäº§$â… ã€â…¡$ä¸¤ç§äº§å“,å·²çŸ¥ç”Ÿäº§å•ä½äº§å“æ‰€éœ€çš„è®¾å¤‡å°æ—¶åŠ$Aã€B$ä¸¤ç§åŸææ–™çš„æ¶ˆè€—,å¦‚è¡¨1-1æ‰€ç¤ºã€‚

![TU1-1](C:\Users\Lenovo\Desktop\TU1-1.png)

å¯ä»¥ç”¨æ•°å­¦æ¨¡å‹è¡¨ç¤º

ç›®æ ‡å‡½æ•°                                                          $max\space z=2x_1+3x_2$
$$
æ»¡è¶³çº¦æŸæ¡ä»¶ï¼š\left\{\begin{array}{c}
x_1+2x_2\le8\\
4x_{1}\le16 \\
4x_2\le12\\
x_{1} ,x_2\geq 0
\end{array}\right.
$$
åŒ–ä¸ºæ ‡å‡†å½¢å¼
$$
max\space z=2x_1+3x_2+0x_3+0x_4+0x_5\\
\left\{\begin{array}{c}
x_1+2x_2+x_3=8\\
4x_{1}+x_4=16 \\
4x_2+x_5=12\\
x_{1} ,x_2,x_3,x_4,x_5\geq 0
\end{array}\right.
$$
çº¦æŸæ–¹ç¨‹çš„ç³»æ•°çŸ©é˜µ
$$
A=(P_1,P_2,P_3,P_4,P_5)=\left[\begin{array}{ccccc}1&2&1&0&0\\
4&0&0&1&0\\
0&4&0&0&1
\end{array}\right]
$$

1. å¾ˆå®¹æ˜“çœ‹å‡ºåˆå§‹å¯è¡ŒåŸº
   $$
   B=(P_3,P_4,P_5)=\left[
   \matrix{
    1 & 0&0\\
     0 &1&0\\
     0 & 0&1
   }
   \right]
   $$
   åŸºå˜é‡ä¸º$x_3,x_4,x_5$ã€‚å®ƒä»¬å’Œ$z$éƒ½å¯ä»¥ç”¨éåŸºå˜é‡$x_1,x_2$è¡¨ç¤º
   $$
   \left\{\begin{array}{c}
   x_3=8-x_1-2x_2\\
   x_4=16-4x_1 \\
   x_5=12-4x_2\\
   
   \end{array}\right.
   $$
   ä»¤éåŸºå˜é‡ä¸º0ï¼Œå¾—åˆ°åˆå§‹åŸºå¯è¡Œè§£
   $$
   X^{(0)}=(0,0,8,16,12)$z=$
   $$
   åˆå§‹å•çº¯è¡Œè¡¨ä¸º

   ![1-3](C:\Users\Lenovo\Desktop\1-3.png)

2. å’Œ3. å› æ£€éªŒæ•°éƒ½å¤§äº0ï¼Œä¸”$P_1,P_2$æœ‰æ­£åˆ†é‡å­˜åœ¨ï¼Œè½¬å…¥ä¸‹ä¸€æ­¥

4. $max(\sigma_1,\sigma_2)=max(2,3)=3$,æ‰€ä»¥å¯¹åº”$x_2$ä¸ºæ¢å…¥å˜é‡ï¼Œè®¡ç®—$\theta$
   $$
   \theta=min(\frac{b_i}{a_{i,2}}|a_{i,2}>0)=min(8/2,-,12/4)=3
   $$
   åˆ™å®ƒå¯¹åº”çš„$x_5$ä¸ºæ¢å‡ºå˜é‡ã€‚$x_2$æ‰€åœ¨åˆ—å’Œ$x_5$æ‰€åœ¨è¡Œçš„äº¤å‰å¤„[4]ç§°ä¸ºä¸»å…ƒç´ æˆ–æ¢å…ƒç´ (pivot element)ã€‚

5. ä»¥[4]ä¸ºä¸»å…ƒç´ è¿›è¡Œæ—‹è½¬è¿ç®—,å³åˆç­‰è¡Œå˜æ¢,ä½¿P2å˜æ¢ä¸º(0,0,1),åœ¨$x_B$åˆ—ä¸­å°†$x_2$æ›¿æ¢$x_5$,äºæ˜¯å¾—åˆ°æ–°è¡¨1-4ã€‚

   ![è¡¨1-4](C:\Users\Lenovo\Desktop\è¡¨1-4.png)

å¾—åˆ°æ–°çš„åŸºå¯è¡Œè§£ä¸º$x^{(1)}=(0,3,2,16,0)^T$ï¼Œç›®æ ‡å‡½æ•°çš„å–å€¼ä¸º$z=9$ã€‚

4. (1-4)ä¸­$x_1$çš„$\sigma=2>0$,æ‰€ä»¥$x_1$ä¸ºæ¢å…¥å˜é‡ï¼Œé‡å¤è¿ç®—ï¼Œå¾—åˆ°è¡¨1-5ã€‚

   ![1-5](C:\Users\Lenovo\Desktop\1-5.png)

4. (1-5)ä¸­$x_5$,$\sigma=1/4>0$,æ‰€ä»¥$x_5$ä¸ºæ¢å…¥å˜é‡ï¼Œé‡å¤è¿ç®—ï¼Œå¾—åˆ°è¡¨1-6ã€‚

   ![1-6](C:\Users\Lenovo\Desktop\1-6.png)

å‘ç°æœ€åä¸€è¡Œæ‰€æœ‰æ£€éªŒæ•°éƒ½å·²ç»ä¸ºè´Ÿæˆ–0ã€‚è¡¨ç¤ºç›®æ ‡å‡½æ•°å€¼å·²ä¸å¯èƒ½å†å¢å¤§ï¼Œäºæ˜¯å¾—åˆ°æœ€ä¼˜è§£
$$
X^{*}=X^{(3)}=(4,2,0,0,4)^T
$$
ç›®æ ‡å‡½æ•°å€¼
$$
z^*=14
$$

##### 4.2.4 ä»£ç å®ç° 

###### 4.2.4.1 pythonå®ç°

~~~python
# çº¿æ€§è§„åˆ’-å•çº¯å½¢ç®—æ³•
import numpy as np
np.set_printoptions(precision=4, suppress=True, threshold=np.inf)
# çº¿æ€§è§„åˆ’è½¬åŒ–ä¸ºæ¾å¼›å½¢å¼
def get_loose_matrix(matrix):
    row, col = matrix.shape
    loose_matrix = np.zeros((row, row + col))
    for i, _ in enumerate(loose_matrix):
        loose_matrix[i, 0: col] = matrix[i]
        loose_matrix[i, col + i] = 1.0  # å¯¹è§’çº¿
    return loose_matrix
# æ¾å¼›å½¢å¼çš„ç³»æ•°çŸ©é˜µAã€çº¦æŸçŸ©é˜µBå’Œç›®æ ‡å‡½æ•°çŸ©é˜µCç»„åˆä¸ºä¸€ä¸ªçŸ©é˜µ
def join_matrix(a, b, c):
    row, col = a.shape
    s = np.zeros((row + 1, col + 1))
    s[1:, 1:] = a  # å³ä¸‹è§’æ˜¯æ¾å¼›ç³»æ•°çŸ©é˜µA
    s[1:, 0] = b  # å·¦ä¸‹è§’æ˜¯çº¦æŸæ¡ä»¶å€¼çŸ©é˜µB
    s[0, 1: len(c) + 1] = c  # å³ä¸Šè§’æ˜¯ç›®æ ‡å‡½æ•°çŸ©é˜µC
    return s
# æ—‹è½¬çŸ©é˜µâ€”æ›¿æ¢æ›¿å‡ºæ›¿å…¥å˜é‡çš„è§’è‰²ä½ç½®
def pivot_matrix(matrix, k, j):
    # å•ç‹¬å¤„ç†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œï¼Œéœ€è¦é™¤ä»¥æ›¿å…¥å˜é‡çš„ç³»æ•°matrix[k][j]
    matrix[k] = matrix[k] / matrix[k][j]
    # å¾ªç¯é™¤äº†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œä¹‹å¤–çš„æ‰€æœ‰è¡Œ
    for i, _ in enumerate(matrix):
        if i != k:
            matrix[i] = matrix[i] - matrix[k] * matrix[i][j]
# æ ¹æ®æ—‹è½¬åçš„çŸ©é˜µï¼Œä»åŸºæœ¬å˜é‡æ•°ç»„ä¸­å¾—åˆ°ä¸€ç»„åŸºè§£
def get_base_solution(matrix, base_ids):
    X = [0.0] * (matrix.shape[1])  # è§£ç©ºé—´
    for i, _ in enumerate(base_ids):
        X[base_ids[i]] = matrix[i + 1][0]
    return X
# æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’
def Laux(matrix, base_ids):
    l_matrix = np.copy(matrix)
    # è¾…åŠ©çŸ©é˜µçš„æœ€åä¸€åˆ—å­˜æ”¾x0çš„ç³»æ•°ï¼Œåˆå§‹åŒ–ä¸º-1
    l_matrix = np.column_stack((l_matrix, [-1] * l_matrix.shape[0]))
    # è¾…åŠ©çº¿æ€§å‡½æ•°çš„ç›®æ ‡å‡½æ•°ä¸ºz = x0
    l_matrix[0, :-1] = 0.0
    l_matrix[0, -1] = 1
    k = l_matrix[1:, 0].argmin() + 1  # é€‰æ‹©ä¸€ä¸ªbæœ€å°çš„é‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
    j = l_matrix.shape[1] - 1   # é€‰æ‹©x0ä½œä¸ºæ›¿å…¥å˜é‡
    # ç¬¬ä¸€æ¬¡æ—‹è½¬çŸ©é˜µï¼Œä½¿å¾—æ‰€æœ‰bä¸ºæ­£æ•°
    pivot_matrix(l_matrix, k=k, j=j)
    base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    # ç”¨å•çº¯å½¢ç®—æ³•æ±‚è§£è¯¥è¾…åŠ©çº¿æ€§è§„åˆ’
    l_matrix = simplex(l_matrix, base_ids)
    # å¦‚æœæ±‚è§£åçš„è¾…åŠ©çº¿æ€§è§„åˆ’ä¸­x0ä»ç„¶æ˜¯åŸºæœ¬å˜é‡ï¼Œéœ€è¦å†æ¬¡æ—‹è½¬æ¶ˆå»x0
    if l_matrix.shape[1] - 1 in base_ids:
        j = np.where(l_matrix[0, 1:] != 0)[0][0] + 1   # æ‰¾åˆ°çŸ©é˜µç¬¬ä¸€è¡Œ(ç›®æ ‡å‡½æ•°)ç³»æ•°ä¸ä¸º0çš„å˜é‡ä½œä¸ºæ›¿å…¥å˜é‡
        k = base_ids.index(l_matrix.shape[1] - 1) + 1  # æ‰¾åˆ°x0ä½œä¸ºåŸºæœ¬å˜é‡æ‰€åœ¨çš„é‚£ä¸€è¡Œï¼Œå°†x0ä½œä¸ºæ›¿å‡ºå˜é‡
        pivot_matrix(l_matrix, k=k, j=j)   # æ—‹è½¬çŸ©é˜µæ¶ˆå»åŸºæœ¬å˜é‡x0
        base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return l_matrix, base_ids
# ä»è¾…åŠ©å‡½æ•°ä¸­æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
def resotr_from_Laux(l_matrix, z, base_ids):
    z_ids = np.where(z != 0)[0] - 1  # å¾—åˆ°ç›®æ ‡å‡½æ•°ç³»æ•°ä¸ä¸º0çš„ç´¢å¼•æ•°ç»„(å³åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„)
    restore_matrix = np.copy(l_matrix[:, 0:-1])  # å»æ‰x0é‚£ä¸€åˆ—
    restore_matrix[0] = z  # åˆå§‹åŒ–çŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸ºåŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°å‘é‡
    for i, base_v in enumerate(base_ids):
        # å¦‚æœåŸé—®é¢˜çš„åŸºæœ¬å˜é‡å­˜åœ¨æ–°åŸºæœ¬å˜é‡æ•°ç»„ä¸­ï¼Œè¯´æ˜éœ€è¦æ›¿æ¢æ¶ˆå»
        if base_v in z_ids:
            restore_matrix[0] -= restore_matrix[0, base_v + 1] * restore_matrix[i + 1]  # æ¶ˆå»åŸç›®æ ‡å‡½æ•°ä¸­çš„åŸºæœ¬å˜é‡
    return restore_matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£çº¿æ€§è§„åˆ’
def simplex(matrix, base_ids):
    matrix = matrix.copy()
    # å¦‚æœç›®æ ‡ç³»æ•°å‘é‡é‡Œæœ‰è´Ÿæ•°ï¼Œåˆ™æ—‹è½¬çŸ©é˜µ
    while matrix[0, 1:].min() < 0:
        # åœ¨ç›®æ ‡å‡½æ•°å‘é‡é‡Œï¼Œé€‰å–ç³»æ•°ä¸ºè´Ÿæ•°çš„ç¬¬ä¸€ä¸ªå˜é‡ç´¢å¼•ï¼Œä½œä¸ºæ›¿å…¥å˜é‡
        j = np.where(matrix[0, 1:] < 0)[0][0] + 1
        # åœ¨çº¦æŸé›†åˆé‡Œï¼Œé€‰å–å¯¹æ›¿å…¥å˜é‡çº¦æŸæœ€ç´§çš„çº¦æŸè¡Œï¼Œé‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
        k = np.array([matrix[i][0] / matrix[i][j] if matrix[i][j] > 0 else 0x7fff for i in
                      range(1, matrix.shape[0])]).argmin() + 1
        # è¯´æ˜åŸé—®é¢˜æ— ç•Œ
        if matrix[k][j] <= 0:
            print('åŸé—®é¢˜æ— ç•Œ')
            return None, None
        pivot_matrix(matrix, k, j)  # æ—‹è½¬æ›¿æ¢æ›¿å…¥å˜é‡å’Œæ›¿å‡ºå˜é‡
        base_ids[k - 1] = j - 1  # ç»´æŠ¤å½“å‰åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£æ­¥éª¤å…¥å£
def solve(a, b, c, equal=None):
    loose_matrix = get_loose_matrix(a)  # è½¬åŒ–å¾—åˆ°æ¾å¼›çŸ©é˜µ
    if equal is not None:
        loose_matrix = np.insert(loose_matrix, 0, equal, axis=0)
    matrix = join_matrix(loose_matrix, b, c)  # å¾—åˆ°ABCçš„ç»„åˆçŸ©é˜µ
    base_ids = list(range(len(c), len(b) + len(c)))  # åˆå§‹åŒ–åŸºæœ¬å˜é‡çš„ç´¢å¼•æ•°ç»„
    # çº¦æŸç³»æ•°çŸ©é˜µæœ‰è´Ÿæ•°çº¦æŸï¼Œè¯æ˜æ²¡æœ‰å¯è¡Œè§£ï¼Œéœ€è¦è¾…åŠ©çº¿æ€§å‡½æ•°
    if matrix[:, 0].min() < 0:
        print('æ„é€ æ±‚è§£è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°...')
        l_matrix, base_ids = Laux(matrix, base_ids)  # æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°å¹¶æ—‹è½¬æ±‚è§£ä¹‹
        if l_matrix is not None:
            matrix = resotr_from_Laux(l_matrix, matrix[0], base_ids)  # æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
        else:
            print('è¾…åŠ©çº¿æ€§å‡½æ•°çš„åŸé—®é¢˜æ²¡æœ‰å¯è¡Œè§£')
            return None, None, None
    ret_matrix = simplex(matrix, base_ids)  # å•çº¯å½¢ç®—æ³•æ±‚è§£æ‹¥æœ‰åŸºæœ¬å¯è¡Œè§£çš„çº¿æ€§è§„åˆ’
    X = get_base_solution(ret_matrix, base_ids)  # å¾—åˆ°å½“å‰æœ€ä¼˜åŸºæœ¬å¯è¡Œè§£
    if ret_matrix is not None:
        return matrix, ret_matrix, X
    else:
        print('åŸçº¿æ€§è§„åˆ’é—®é¢˜æ— ç•Œ')
        return None, None, None
if __name__ == '__main__':
    equal = None
    # ä¸å¸¦ç­‰å¼çº¦æŸçš„çº¿æ€§è§„åˆ’æµ‹è¯•
    # a = np.array([[4, -1], [2, 1], [-5, 2]])
    # b = [8, 10, 2]
    # c = [-1, -1]
    # a = np.array([[1, 1], [-1, -1]])
    # b = [2, -1]
    # c = [1, 2]
    # a = np.array([[1, -1], [-1.5, 1], [50, 20]])
    # b = [0, 0, 2000]
    # c = [-1, -1]
    # a = np.array([[1, 1, 1, 1], [4, 8, 2, 5], [4, 2, 5, 5], [6, 4, 8, 4]])
    # b = [480, 2400, 2000, 3000]
    # c = [-9, -6, -11, -8]
    # a = np.array([[1, -1], [-1, -1], [-1, 4]])
    # b = [8, -3, 2]
    # c = [-1, -3]
    # a = np.array([[-21, 0, 0, 0], [0, -28, -4, 0], [-2, -1, -10, -11]])
    # b = [-500, -600, -250]
    # c = [1, 1, 1, 1]
    # a = np.array([[2, -1], [1, -5]])
    # b = [2, -4]
    # c = [-2, 1]
    # å¸¦ç­‰å¼çº¦æŸçš„çº¿æ€§è§„åˆ’æµ‹è¯•
    # a = np.array([[1, -2]])
    # equal = [1, 1] + [0] * a.shape[0]
    # b = [7, 4]
    # c = [-2, 3]
    # a = np.array([[1, -2, 1], [4, -1, -2]])
    # equal = [-2, 0, 1] + [0] * a.shape[0]
    # b = [1, 11, -3]
    # c = [-3, 1, 1]
    a = np.array([[-2, 5, -1], [1, 3, 1]])
    equal = [1, 1, 1] + [0] * a.shape[0]
    b = [7, -10, 12]
    c = [-2, -3, 5]
    matrix, ret_matrix, X = solve(a, b, c, equal=equal)
    print('æœ¬æ¬¡è¿­ä»£çš„æœ€ä¼˜è§£ä¸ºï¼š{}'.format(np.round(X[0: len(c)], 4)))
    print('è¯¥çº¿æ€§è§„åˆ’çš„æœ€ä¼˜å€¼æ˜¯ï¼š{}'.format(np.round(-ret_matrix[0][0], 4)))
~~~

~~~python
'''
çº¿æ€§è§„åˆ’å®æˆ˜â€”è¿ç»­æŠ•èµ„é—®é¢˜
è€ƒè™‘ä¸‹åˆ—æŠ•èµ„é¡¹ç›®ï¼š
é¡¹ç›®Aï¼šåœ¨ç¬¬1~4å¹´æ¯å¹´å¹´åˆå¯ä»¥æŠ•èµ„ï¼Œå¹¶äºæ¬¡å¹´å¹´æœ«æ”¶å›æœ¬åˆ©115%ï¼›
é¡¹ç›®Bï¼šç¬¬3å¹´å¹´åˆå¯ä»¥æŠ•èµ„ï¼Œä¸€ç›´åˆ°ç¬¬5å¹´å¹´æœ«èƒ½æ”¶å›æœ¬åˆ©125%ï¼Œä¸”è§„å®šæœ€å¤§æŠ•èµ„é¢ä¸è¶…è¿‡4ä¸‡å…ƒï¼›
é¡¹ç›®Cï¼šç¬¬2å¹´å¹´åˆå¯ä»¥æŠ•èµ„ï¼Œä¸€ç›´åˆ°ç¬¬5å¹´å¹´æœ«èƒ½æ”¶å›æœ¬åˆ©140%ï¼Œä¸”è§„å®šæœ€å¤§æŠ•èµ„é¢ä¸è¶…è¿‡3ä¸‡å…ƒï¼›
é¡¹ç›®Dï¼š5å¹´å†…æ¯ä¸€å¹´å¹´åˆå‡å¯ä»¥è´­ä¹°å…¬å€ºï¼Œå¹¶äºå½“å¹´å¹´æœ«å½’è¿˜æœ¬é‡‘ï¼Œå¹¶åŠ è·å¾—åˆ©æ¯6%ã€‚
å¦‚æœä½ æœ‰10ä¸‡å…ƒæœ¬é‡‘ï¼Œæ±‚ç¡®å®šä¸€ä¸ªæœ‰æ•ˆçš„æŠ•èµ„æ–¹æ¡ˆï¼Œä½¿å¾—ç¬¬5å¹´å¹´æœ«ä½ æ‹¥æœ‰çš„èµ„é‡‘çš„æœ¬åˆ©æ€»é¢æœ€å¤§ï¼Ÿ
'''
import numpy as np
from copy import deepcopy
np.set_printoptions(precision=4, suppress=True, threshold=np.inf)
# çº¿æ€§è§„åˆ’è½¬åŒ–ä¸ºæ¾å¼›å½¢å¼
def get_loose_matrix(matrix):
    row, col = matrix.shape
    loose_matrix = np.zeros((row, row + col))
    for i, _ in enumerate(loose_matrix):
        loose_matrix[i, 0: col] = matrix[i]
        loose_matrix[i, col + i] = 1.0  # å¯¹è§’çº¿
    return loose_matrix
# æ¾å¼›å½¢å¼çš„ç³»æ•°çŸ©é˜µAã€çº¦æŸçŸ©é˜µBå’Œç›®æ ‡å‡½æ•°çŸ©é˜µCç»„åˆä¸ºä¸€ä¸ªçŸ©é˜µ
def join_matrix(a, b, c):
    row, col = a.shape
    s = np.zeros((row + 1, col + 1))
    s[1:, 1:] = a  # å³ä¸‹è§’æ˜¯æ¾å¼›ç³»æ•°çŸ©é˜µA
    s[1:, 0] = b  # å·¦ä¸‹è§’æ˜¯çº¦æŸæ¡ä»¶å€¼çŸ©é˜µB
    s[0, 1: len(c) + 1] = c  # å³ä¸Šè§’æ˜¯ç›®æ ‡å‡½æ•°çŸ©é˜µC
    return s
# æ—‹è½¬çŸ©é˜µâ€”æ›¿æ¢æ›¿å‡ºæ›¿å…¥å˜é‡çš„è§’è‰²ä½ç½®
def pivot_matrix(matrix, k, j):
    # å•ç‹¬å¤„ç†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œï¼Œéœ€è¦é™¤ä»¥æ›¿å…¥å˜é‡çš„ç³»æ•°matrix[k][j]
    matrix[k] = matrix[k] / matrix[k][j]
    # å¾ªç¯é™¤äº†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œä¹‹å¤–çš„æ‰€æœ‰è¡Œ
    for i, _ in enumerate(matrix):
        if i != k:
            matrix[i] = matrix[i] - matrix[k] * matrix[i][j]
# æ ¹æ®æ—‹è½¬åçš„çŸ©é˜µï¼Œä»åŸºæœ¬å˜é‡æ•°ç»„ä¸­å¾—åˆ°ä¸€ç»„åŸºè§£
def get_base_solution(matrix, base_ids):
    X = [0.0] * (matrix.shape[1])  # è§£ç©ºé—´
    for i, _ in enumerate(base_ids):
        X[base_ids[i]] = matrix[i + 1][0]
    return X
# æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’
def Laux(matrix, base_ids):
    l_matrix = np.copy(matrix)
    # è¾…åŠ©çŸ©é˜µçš„æœ€åä¸€åˆ—å­˜æ”¾x0çš„ç³»æ•°ï¼Œåˆå§‹åŒ–ä¸º-1
    l_matrix = np.column_stack((l_matrix, [-1] * l_matrix.shape[0]))
    # è¾…åŠ©çº¿æ€§å‡½æ•°çš„ç›®æ ‡å‡½æ•°ä¸ºz = x0
    l_matrix[0, :-1] = 0.0
    l_matrix[0, -1] = 1
    k = l_matrix[1:, 0].argmin() + 1  # é€‰æ‹©ä¸€ä¸ªbæœ€å°çš„é‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
    j = l_matrix.shape[1] - 1   # é€‰æ‹©x0ä½œä¸ºæ›¿å…¥å˜é‡
    # ç¬¬ä¸€æ¬¡æ—‹è½¬çŸ©é˜µï¼Œä½¿å¾—æ‰€æœ‰bä¸ºæ­£æ•°
    pivot_matrix(l_matrix, k=k, j=j)
    base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    # ç”¨å•çº¯å½¢ç®—æ³•æ±‚è§£è¯¥è¾…åŠ©çº¿æ€§è§„åˆ’
    l_matrix = simplex(l_matrix, base_ids)
    # å¦‚æœæ±‚è§£åçš„è¾…åŠ©çº¿æ€§è§„åˆ’ä¸­x0ä»ç„¶æ˜¯åŸºæœ¬å˜é‡ï¼Œéœ€è¦å†æ¬¡æ—‹è½¬æ¶ˆå»x0
    if l_matrix.shape[1] - 1 in base_ids:
        j = np.where(l_matrix[0, 1:] != 0)[0][0] + 1   # æ‰¾åˆ°çŸ©é˜µç¬¬ä¸€è¡Œ(ç›®æ ‡å‡½æ•°)ç³»æ•°ä¸ä¸º0çš„å˜é‡ä½œä¸ºæ›¿å…¥å˜é‡
        k = base_ids.index(l_matrix.shape[1] - 1) + 1  # æ‰¾åˆ°x0ä½œä¸ºåŸºæœ¬å˜é‡æ‰€åœ¨çš„é‚£ä¸€è¡Œï¼Œå°†x0ä½œä¸ºæ›¿å‡ºå˜é‡
        pivot_matrix(l_matrix, k=k, j=j)   # æ—‹è½¬çŸ©é˜µæ¶ˆå»åŸºæœ¬å˜é‡x0
        base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return l_matrix, base_ids
# ä»è¾…åŠ©å‡½æ•°ä¸­æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
def resotr_from_Laux(l_matrix, z, base_ids):
    z_ids = np.where(z != 0)[0] - 1  # å¾—åˆ°ç›®æ ‡å‡½æ•°ç³»æ•°ä¸ä¸º0çš„ç´¢å¼•æ•°ç»„(å³åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„)
    restore_matrix = np.copy(l_matrix[:, 0:-1])  # å»æ‰x0é‚£ä¸€åˆ—
    restore_matrix[0] = z  # åˆå§‹åŒ–çŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸ºåŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°å‘é‡
    for i, base_v in enumerate(base_ids):
        # å¦‚æœåŸé—®é¢˜çš„åŸºæœ¬å˜é‡å­˜åœ¨æ–°åŸºæœ¬å˜é‡æ•°ç»„ä¸­ï¼Œè¯´æ˜éœ€è¦æ›¿æ¢æ¶ˆå»
        if base_v in z_ids:
            restore_matrix[0] -= restore_matrix[0, base_v + 1] * restore_matrix[i + 1]  # æ¶ˆå»åŸç›®æ ‡å‡½æ•°ä¸­çš„åŸºæœ¬å˜é‡
    return restore_matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£çº¿æ€§è§„åˆ’
def simplex(matrix, base_ids):
    matrix = matrix.copy()
    # å¦‚æœç›®æ ‡ç³»æ•°å‘é‡é‡Œæœ‰è´Ÿæ•°ï¼Œåˆ™æ—‹è½¬çŸ©é˜µ
    while matrix[0, 1:].min() < 0:
        # åœ¨ç›®æ ‡å‡½æ•°å‘é‡é‡Œï¼Œé€‰å–ç³»æ•°ä¸ºè´Ÿæ•°çš„ç¬¬ä¸€ä¸ªå˜é‡ç´¢å¼•ï¼Œä½œä¸ºæ›¿å…¥å˜é‡
        j = np.where(matrix[0, 1:] < 0)[0][0] + 1
        # åœ¨çº¦æŸé›†åˆé‡Œï¼Œé€‰å–å¯¹æ›¿å…¥å˜é‡çº¦æŸæœ€ç´§çš„çº¦æŸè¡Œï¼Œé‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
        k = np.array([matrix[i][0] / matrix[i][j] if matrix[i][j] > 0 else 0x7fff for i in
                      range(1, matrix.shape[0])]).argmin() + 1
        # print('æ›¿å‡ºå˜é‡ä¸ºï¼š{}ï¼Œæ›¿å…¥å˜é‡ä¸ºï¼š{}ï¼Œ å€¼ä¸ºï¼š{}'.format(k, j, matrix[k][j]))
        # è¯´æ˜åŸé—®é¢˜æ— ç•Œ
        if matrix[k][j] <= 0:
            print('åŸé—®é¢˜æ— ç•Œ')
            return None, None
        pivot_matrix(matrix, k, j)  # æ—‹è½¬æ›¿æ¢æ›¿å…¥å˜é‡å’Œæ›¿å‡ºå˜é‡
        base_ids[k - 1] = j - 1  # ç»´æŠ¤å½“å‰åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£æ­¥éª¤å…¥å£
def solve(a, b, c, equal=None):
    loose_matrix = get_loose_matrix(a)  # è½¬åŒ–å¾—åˆ°æ¾å¼›çŸ©é˜µ
    if equal is not None:
        for i, e in enumerate(equal):
            loose_matrix = np.insert(loose_matrix, i, e, axis=0)
    matrix = join_matrix(loose_matrix, b, c)  # å¾—åˆ°ABCçš„ç»„åˆçŸ©é˜µ
    base_ids = list(range(len(c), len(b) + len(c)))  # åˆå§‹åŒ–åŸºæœ¬å˜é‡çš„ç´¢å¼•æ•°ç»„
    # çº¦æŸç³»æ•°çŸ©é˜µæœ‰è´Ÿæ•°çº¦æŸï¼Œè¯æ˜æ²¡æœ‰å¯è¡Œè§£ï¼Œéœ€è¦è¾…åŠ©çº¿æ€§å‡½æ•°
    if matrix[:, 0].min() < 0:
        print('æ„é€ æ±‚è§£è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°...')
        l_matrix, base_ids = Laux(matrix, base_ids)  # æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°å¹¶æ—‹è½¬æ±‚è§£ä¹‹
        if l_matrix is not None:
            matrix = resotr_from_Laux(l_matrix, matrix[0], base_ids)  # æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
        else:
            print('è¾…åŠ©çº¿æ€§å‡½æ•°çš„åŸé—®é¢˜æ²¡æœ‰å¯è¡Œè§£')
            return None, None, None
    ret_matrix = simplex(matrix, base_ids)  # å•çº¯å½¢ç®—æ³•æ±‚è§£æ‹¥æœ‰åŸºæœ¬å¯è¡Œè§£çš„çº¿æ€§è§„åˆ’
    X = get_base_solution(ret_matrix, base_ids)  # å¾—åˆ°å½“å‰æœ€ä¼˜åŸºæœ¬å¯è¡Œè§£
    if ret_matrix is not None:
        return matrix, ret_matrix, X
    else:
        print('åŸçº¿æ€§è§„åˆ’é—®é¢˜æ— ç•Œ')
        return None, None, None
if __name__ == '__main__':
    x = [0 for _ in range(20)]  # å®šä¹‰å†³ç­–å˜é‡
    e1, e2, e3, e4, e5 = deepcopy(x), deepcopy(x), deepcopy(x), deepcopy(x), deepcopy(x)  # ç­‰å¼çº¦æŸ
    e1[0], e1[15] = 1, 1
    e2[1], e2[11], e2[16], e2[15] = 1, 1, 1, -1.06
    e3[2], e3[7], e3[17], e3[0], e3[16] = 1, 1, 1, -1.15, -1.06
    e4[3], e4[18], e4[1], e4[17] = 1, 1, -1.15, -1.06
    e5[19], e5[2], e5[18] = 1, -1.15, -1.06
    a1, a2 = deepcopy(x), deepcopy(x)  # ä¸ç­‰å¼çº¦æŸ
    a1[7] = 1
    a2[11] = 1
    a = np.array([a1, a2])
    b = [10, 0, 0, 0, 0] + [4, 3]
    equal = []
    equal.append(e1 + [0] * a.shape[0])
    equal.append(e2 + [0] * a.shape[0])
    equal.append(e3 + [0] * a.shape[0])
    equal.append(e4 + [0] * a.shape[0])
    equal.append(e5 + [0] * a.shape[0])
    c = deepcopy(x)  # ç›®æ ‡å‡½æ•°
    c[3], c[7], c[11], c[19] = -1.15, -1.25, -1.4, -1.06
    # å•çº¯å½¢æ³•æ±‚è§£æ•°å­¦æ¨¡å‹
    matrix, ret_matrix, X = solve(a, b, c, equal=equal)
    Y = np.round(np.array(X[0: len(c)]).reshape(4, -1).T, 4)  # å¾—åˆ°æœ€ä¼˜æŠ•èµ„æ–¹æ¡ˆ
    print(Y)
    for i, y in enumerate(Y):
        print('ç¬¬{}å¹´å¹´åˆæŠ•èµ„ç»„åˆï¼šé¡¹ç›®Aï¼š{}ä¸‡å…ƒï¼Œé¡¹ç›®Bï¼š{}ä¸‡å…ƒï¼Œé¡¹ç›®Cï¼š{}ä¸‡å…ƒï¼Œé¡¹ç›®Dï¼š{}ä¸‡å…ƒï¼Œè¯¥å¹´æ€»æŠ•å…¥ï¼š{}ä¸‡å…ƒ'.format(
            i + 1, y[-4], y[-3], y[-2], y[-1], np.sum(y)))
    total_money = np.abs(np.round(-ret_matrix[0][0], 4))  # æ€»æ”¶å…¥æœ¬æ¯
    profit = np.round((total_money - b[0]) / b[0] * 100, 4)  # æ€»èµ¢åˆ©
    print('ç¬¬5å¹´å¹´æœ«æ€»æ”¶å…¥æœ¬é‡‘+åˆ©æ¯ä¸ºï¼š{}ä¸‡å…ƒï¼Œæ€»èµ¢åˆ©ï¼š{}%'.format(total_money, profit))
~~~

~~~python
# çº¿æ€§è§„åˆ’å®æˆ˜â€”æŠ•èµ„çš„æ”¶ç›Šå’Œé£é™©
import numpy as np
from copy import deepcopy
import matplotlib.pyplot as plt
np.set_printoptions(precision=4, suppress=True, threshold=np.inf)
# çº¿æ€§è§„åˆ’è½¬åŒ–ä¸ºæ¾å¼›å½¢å¼
def get_loose_matrix(matrix):
    row, col = matrix.shape
    loose_matrix = np.zeros((row, row + col))
    for i, _ in enumerate(loose_matrix):
        loose_matrix[i, 0: col] = matrix[i]
        loose_matrix[i, col + i] = 1.0  # å¯¹è§’çº¿
    return loose_matrix
# æ¾å¼›å½¢å¼çš„ç³»æ•°çŸ©é˜µAã€çº¦æŸçŸ©é˜µBå’Œç›®æ ‡å‡½æ•°çŸ©é˜µCç»„åˆä¸ºä¸€ä¸ªçŸ©é˜µ
def join_matrix(a, b, c):
    row, col = a.shape
    s = np.zeros((row + 1, col + 1))
    s[1:, 1:] = a  # å³ä¸‹è§’æ˜¯æ¾å¼›ç³»æ•°çŸ©é˜µA
    s[1:, 0] = b  # å·¦ä¸‹è§’æ˜¯çº¦æŸæ¡ä»¶å€¼çŸ©é˜µB
    s[0, 1: len(c) + 1] = c  # å³ä¸Šè§’æ˜¯ç›®æ ‡å‡½æ•°çŸ©é˜µC
    return s
# æ—‹è½¬çŸ©é˜µâ€”æ›¿æ¢æ›¿å‡ºæ›¿å…¥å˜é‡çš„è§’è‰²ä½ç½®
def pivot_matrix(matrix, k, j):
    # å•ç‹¬å¤„ç†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œï¼Œéœ€è¦é™¤ä»¥æ›¿å…¥å˜é‡çš„ç³»æ•°matrix[k][j]
    matrix[k] = matrix[k] / matrix[k][j]
    # å¾ªç¯é™¤äº†æ›¿å‡ºå˜é‡æ‰€åœ¨è¡Œä¹‹å¤–çš„æ‰€æœ‰è¡Œ
    for i, _ in enumerate(matrix):
        if i != k:
            matrix[i] = matrix[i] - matrix[k] * matrix[i][j]
# æ ¹æ®æ—‹è½¬åçš„çŸ©é˜µï¼Œä»åŸºæœ¬å˜é‡æ•°ç»„ä¸­å¾—åˆ°ä¸€ç»„åŸºè§£
def get_base_solution(matrix, base_ids):
    X = [0.0] * (matrix.shape[1])  # è§£ç©ºé—´
    for i, _ in enumerate(base_ids):
        X[base_ids[i]] = matrix[i + 1][0]
    return X
# æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’
def Laux(matrix, base_ids):
    l_matrix = np.copy(matrix)
    # è¾…åŠ©çŸ©é˜µçš„æœ€åä¸€åˆ—å­˜æ”¾x0çš„ç³»æ•°ï¼Œåˆå§‹åŒ–ä¸º-1
    l_matrix = np.column_stack((l_matrix, [-1] * l_matrix.shape[0]))
    # è¾…åŠ©çº¿æ€§å‡½æ•°çš„ç›®æ ‡å‡½æ•°ä¸ºz = x0
    l_matrix[0, :-1] = 0.0
    l_matrix[0, -1] = 1
    k = l_matrix[1:, 0].argmin() + 1  # é€‰æ‹©ä¸€ä¸ªbæœ€å°çš„é‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
    j = l_matrix.shape[1] - 1   # é€‰æ‹©x0ä½œä¸ºæ›¿å…¥å˜é‡
    # ç¬¬ä¸€æ¬¡æ—‹è½¬çŸ©é˜µï¼Œä½¿å¾—æ‰€æœ‰bä¸ºæ­£æ•°
    pivot_matrix(l_matrix, k=k, j=j)
    base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    # ç”¨å•çº¯å½¢ç®—æ³•æ±‚è§£è¯¥è¾…åŠ©çº¿æ€§è§„åˆ’
    l_matrix = simplex(l_matrix, base_ids)
    # å¦‚æœæ±‚è§£åçš„è¾…åŠ©çº¿æ€§è§„åˆ’ä¸­x0ä»ç„¶æ˜¯åŸºæœ¬å˜é‡ï¼Œéœ€è¦å†æ¬¡æ—‹è½¬æ¶ˆå»x0
    if l_matrix.shape[1] - 1 in base_ids:
        j = np.where(l_matrix[0, 1:] != 0)[0][0] + 1   # æ‰¾åˆ°çŸ©é˜µç¬¬ä¸€è¡Œ(ç›®æ ‡å‡½æ•°)ç³»æ•°ä¸ä¸º0çš„å˜é‡ä½œä¸ºæ›¿å…¥å˜é‡
        k = base_ids.index(l_matrix.shape[1] - 1) + 1  # æ‰¾åˆ°x0ä½œä¸ºåŸºæœ¬å˜é‡æ‰€åœ¨çš„é‚£ä¸€è¡Œï¼Œå°†x0ä½œä¸ºæ›¿å‡ºå˜é‡
        pivot_matrix(l_matrix, k=k, j=j)   # æ—‹è½¬çŸ©é˜µæ¶ˆå»åŸºæœ¬å˜é‡x0
        base_ids[k - 1] = j  # ç»´æŠ¤åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return l_matrix, base_ids
# ä»è¾…åŠ©å‡½æ•°ä¸­æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
def resotr_from_Laux(l_matrix, z, base_ids):
    z_ids = np.where(z != 0)[0] - 1  # å¾—åˆ°ç›®æ ‡å‡½æ•°ç³»æ•°ä¸ä¸º0çš„ç´¢å¼•æ•°ç»„(å³åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„)
    restore_matrix = np.copy(l_matrix[:, 0:-1])  # å»æ‰x0é‚£ä¸€åˆ—
    restore_matrix[0] = z  # åˆå§‹åŒ–çŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸ºåŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°å‘é‡
    for i, base_v in enumerate(base_ids):
        # å¦‚æœåŸé—®é¢˜çš„åŸºæœ¬å˜é‡å­˜åœ¨æ–°åŸºæœ¬å˜é‡æ•°ç»„ä¸­ï¼Œè¯´æ˜éœ€è¦æ›¿æ¢æ¶ˆå»
        if base_v in z_ids:
            restore_matrix[0] -= restore_matrix[0, base_v + 1] * restore_matrix[i + 1]  # æ¶ˆå»åŸç›®æ ‡å‡½æ•°ä¸­çš„åŸºæœ¬å˜é‡
    return restore_matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£çº¿æ€§è§„åˆ’
def simplex(matrix, base_ids):
    matrix = matrix.copy()
    # å¦‚æœç›®æ ‡ç³»æ•°å‘é‡é‡Œæœ‰è´Ÿæ•°ï¼Œåˆ™æ—‹è½¬çŸ©é˜µ
    while matrix[0, 1:].min() < 0:
        # åœ¨ç›®æ ‡å‡½æ•°å‘é‡é‡Œï¼Œé€‰å–ç³»æ•°ä¸ºè´Ÿæ•°çš„ç¬¬ä¸€ä¸ªå˜é‡ç´¢å¼•ï¼Œä½œä¸ºæ›¿å…¥å˜é‡
        j = np.where(matrix[0, 1:] < 0)[0][0] + 1
        # åœ¨çº¦æŸé›†åˆé‡Œï¼Œé€‰å–å¯¹æ›¿å…¥å˜é‡çº¦æŸæœ€ç´§çš„çº¦æŸè¡Œï¼Œé‚£ä¸€è¡Œçš„åŸºæœ¬å˜é‡ä½œä¸ºæ›¿å‡ºå˜é‡
        k = np.array([matrix[i][0] / matrix[i][j] if matrix[i][j] > 0 else 0x7fff for i in
                      range(1, matrix.shape[0])]).argmin() + 1
        # è¯´æ˜åŸé—®é¢˜æ— ç•Œ
        if matrix[k][j] <= 0:
            print('åŸé—®é¢˜æ— ç•Œ')
            return None, None
        pivot_matrix(matrix, k, j)  # æ—‹è½¬æ›¿æ¢æ›¿å…¥å˜é‡å’Œæ›¿å‡ºå˜é‡
        base_ids[k - 1] = j - 1  # ç»´æŠ¤å½“å‰åŸºæœ¬å˜é‡ç´¢å¼•æ•°ç»„
    return matrix
# å•çº¯å½¢ç®—æ³•æ±‚è§£æ­¥éª¤å…¥å£
def solve(a, b, c, equal=None):
    loose_matrix = get_loose_matrix(a)  # è½¬åŒ–å¾—åˆ°æ¾å¼›çŸ©é˜µ
    if equal is not None:
        loose_matrix = np.insert(loose_matrix, 0, equal, axis=0)
    matrix = join_matrix(loose_matrix, b, c)  # å¾—åˆ°ABCçš„ç»„åˆçŸ©é˜µ
    base_ids = list(range(len(c), len(b) + len(c)))  # åˆå§‹åŒ–åŸºæœ¬å˜é‡çš„ç´¢å¼•æ•°ç»„
    # çº¦æŸç³»æ•°çŸ©é˜µæœ‰è´Ÿæ•°çº¦æŸï¼Œè¯æ˜æ²¡æœ‰å¯è¡Œè§£ï¼Œéœ€è¦è¾…åŠ©çº¿æ€§å‡½æ•°
    if matrix[:, 0].min() < 0:
        print('æ„é€ æ±‚è§£è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°...')
        l_matrix, base_ids = Laux(matrix, base_ids)  # æ„é€ è¾…åŠ©çº¿æ€§è§„åˆ’å‡½æ•°å¹¶æ—‹è½¬æ±‚è§£ä¹‹
        if l_matrix is not None:
            matrix = resotr_from_Laux(l_matrix, matrix[0], base_ids)  # æ¢å¤åŸé—®é¢˜çš„ç›®æ ‡å‡½æ•°
        else:
            print('è¾…åŠ©çº¿æ€§å‡½æ•°çš„åŸé—®é¢˜æ²¡æœ‰å¯è¡Œè§£')
            return None, None, None
    ret_matrix = simplex(matrix, base_ids)  # å•çº¯å½¢ç®—æ³•æ±‚è§£æ‹¥æœ‰åŸºæœ¬å¯è¡Œè§£çš„çº¿æ€§è§„åˆ’
    X = get_base_solution(ret_matrix, base_ids)  # å¾—åˆ°å½“å‰æœ€ä¼˜åŸºæœ¬å¯è¡Œè§£
    if ret_matrix is not None:
        return matrix, ret_matrix, X
    else:
        print('åŸçº¿æ€§è§„åˆ’é—®é¢˜æ— ç•Œ')
        return None, None, None
# ç”»å›¾æ˜¾ç¤ºç»“æœ
def draw_result(x, y):
    plt.plot(x, y, color='r', linestyle=':', marker='*', label='Profit / Risk')
    plt.legend()
    plt.xlabel('Risk')
    plt.ylabel('Profit')
    plt.plot([x[6], x[6]], [y[0], y[6]], color='g', linestyle='--')
    plt.scatter([x[6], ], [y[6], ], 50, color='red')
    plt.annotate('Risk={0}\nProfit={1}'.format(round(x[6], 4), round(y[6], 4)), xy=(x[6], y[6]), xytext=(-20, 20),
                 textcoords='offset points', fontsize=12)
    plt.plot([x[25], x[25]], [y[0], y[25]], color='g', linestyle='--')
    plt.scatter([x[25], ], [y[25], ], 50, color='red')
    plt.annotate('Risk={0}\nProfit={1}'.format(round(x[25], 4), round(y[25], 4)), xy=(x[25], y[25]), xytext=(-20, -40),
                 textcoords='offset points', fontsize=12)
    plt.show()
if __name__ == '__main__':
    a = np.array([[0, 0.025, 0, 0, 0], [0, 0, 0.015, 0, 0],
                  [0, 0, 0, 0.055, 0], [0, 0, 0, 0, 0.026]])  # ä¸ç­‰å¼çº¦æŸç³»æ•°
    equal = [1, 1.01, 1.02, 1.045, 1.065] + [0] * a.shape[0]  # ç­‰å¼çº¦æŸç³»æ•°
    c = [-0.05, -0.27, -0.19, -0.185, -0.185]  # ç›®æ ‡å‡½æ•°ç³»æ•°
    M = 1  # æ€»æŠ•èµ„
    risk = 0.0 / M  # é£é™©ç‡
    x_point, y_point = [], []  # ä¸åŒé£é™©å¯¹åº”çš„æ”¶ç›Šç‚¹
    while risk < 0.05:
        b = [M] + [risk] * a.shape[0]  # Mä¸ºç­‰å¼çº¦æŸï¼Œå…¶ä½™ä¸ºä¸ç­‰å¼çº¦æŸ
        matrix, ret_matrix, X = solve(np.copy(a), deepcopy(b), deepcopy(c), deepcopy(equal))  # å•çº¯å½¢ç®—æ³•æ±‚è§£ç›®æ ‡å‡½æ•°
        if ret_matrix is not None:
            print('ç­‰å¼çº¦æŸæ£€æŸ¥', np.dot(equal, X[0:-1]))
            print('å½“é£é™©ç‡ä¸º{}æ—¶ï¼Œæœ¬æ¬¡è¿­ä»£çš„æœ€ä¼˜è§£ä¸ºï¼š{}'.format(np.round(risk, 4), np.round(X[0: len(c)], 4).tolist()))
            print('è¯¥çº¿æ€§è§„åˆ’çš„æœ€ä¼˜å€¼æ˜¯ï¼š{}'.format(np.round(ret_matrix[0][0], 4)))
            x_point.append(risk)
            y_point.append(ret_matrix[0][0])
        risk += 0.001
    draw_result(x_point, y_point)
~~~

#### 4.3 å¯¹å¶å•çº¯å½¢æ³•

##### 4.3.1 æ¦‚å¿µ

> å¯¹å¶å•çº¯å½¢æ³•æ ¹æ®å¯¹å¶é—®é¢˜çš„å¯¹ç§°æ€§, å¯ä»¥ä¿æŒå¯¹å¶é—®é¢˜åŸºæœ¬è§£æ˜¯å¯è¡Œè§£, è€ŒåŸé—®é¢˜ç”±ä¸å¯è¡ŒåŸºæœ¬è§£å¼€å§‹, é€šè¿‡è¿­ä»£, é€æ­¥è¾¾åˆ°åŸºæœ¬å¯è¡Œè§£, è¿™æ ·ä¹Ÿä½¿åŸé—®é¢˜ä¸å¯¹å¶é—®é¢˜éƒ½è¾¾åˆ°æœ€ä¼˜, é‡‡ç”¨è¿™ç§æ€æƒ³çš„ä¼˜åŒ–æ–¹æ³•ç§°ä¸ºå¯¹å¶å•çº¯å½¢æ³•ã€‚

##### 4.3.2 é€‚ç”¨èŒƒå›´

1.  å¯¹å˜é‡è¾ƒå°‘è€Œçº¦æŸå¾ˆå¤šçš„çº¿æ€§è§„åˆ’é—®é¢˜, é¦–å…ˆå°†å…¶å˜ä¸ºå¯¹å¶é—®é¢˜,å†ç”¨å¯¹å¶å•çº¯å½¢æ³•æ±‚è§£, ä»è€Œç®€åŒ–è®¡ç®—ã€‚(è¿™æ˜¯å› ä¸ºåœ¨å•çº¯å½¢æ³•çš„è®¡ç®—ä¸­, å·¥ä½œé‡çš„å¤§å°ä¸»è¦å–å†³äºçº¦æŸæ¡ä»¶çš„å¤šå°‘è€Œä¸æ˜¯å˜é‡çš„å¤šå°‘)

2. æ­¤æ³•ç”¨äº**çµæ•åº¦åˆ†æ**

   æ¦‚å¿µï¼š

   çµæ•åº¦åˆ†æä»¥ä¸Šåœ¨è®¨è®ºçº¿æ€§è§„åˆ’æ—¶, å‡æŠŠ $C_j ,a_{ij} ,b_i$ çœ‹åšå¸¸æ•°,  ä½†å®é™…ä¸Šè¿™äº›æ•°æ®æœ‰çš„æ˜¯æµ‹é‡å€¼, æœ‰çš„æ˜¯ç»éªŒå€¼, æ—¢éç»å¯¹å‡†ç¡®, ä¹Ÿéç¨³å®šä¸å˜, å› æ­¤, æœ‰å¿…è¦åˆ†ææ•°æ®å‘ç”Ÿæ³¢åŠ¨æ—¶,  å¯¹å½“å‰æœ€ä¼˜è§£å’Œæœ€ä¼˜å€¼æœ‰ä½•å½±å“, è¿™å°±æ˜¯æ‰€è°“çš„çµæ•åº¦åˆ†æã€‚

   çµæ•åº¦åˆ†æé€šå¸¸æœ‰ä¸¤ç±»é—®é¢˜: 

   ä¸€æ˜¯å½“ Cã€Aã€b ä¸­æŸéƒ¨åˆ†æ•°æ®å‘ç”Ÿç»™å®šçš„å˜åŒ–æ—¶,  è®¨è®ºæœ€ä¼˜è§£å’Œæœ€ä¼˜å€¼å¦‚ä½•å˜åŒ–; 

   äºŒæ˜¯åˆ†æ Cã€Aã€ b ä¸­æ•°æ®åœ¨å¤šå¤§èŒƒå›´å†…æ³¢åŠ¨, åŸæœ€ä¼˜åŸºä»ä¿æŒä¸å˜, åŒæ—¶æœ€ä¼˜è§£å’Œæœ€ä¼˜å€¼å¦‚ä½•å˜åŒ–ã€‚

##### 4.3.2 æ­¥éª¤ 

##### 4.3.3. å®ä¾‹ 

##### 4.3.4 ä»£ç å®ç° ğŸŒŸ

ç®€è¿°ï¼š**COPTçš„Pythonæ¥å£**ï¼Œæ‰‹åŠ¨è®¾ç½®æ¨¡å‹ï¼Œæ‰‹åŠ¨è®¾ç½®æ±‚è§£æ—¶é—´ï¼Œ**å¯¹å¶å•çº¯å½¢æ³•**æ±‚è§£**LP**é—®é¢˜

ä»£ç ï¼š

 [lp.py](lp.py) 

```python
"""
The problem to solve:

    Maximize:
        1.2x + 1.8y + 2.1z

    Subject to:
        1.5x + 1.2y + 1.8z <= 2.6
        0.8x + 0.6y + 0.9z >= 1.2

    where:
        0.1 <= x <= 0.6
        0.2 <= y <= 1.5
        0.3 <= z <= 2.8
"""

# Import the Python interface library
from coptpy import *

# Create COPT environment
env = Envr()

# Create COPT model
model = env.createModel("lp_ex1")

# Add variables: x, y, z
x = model.addVar(lb=0.1, ub=0.6, name="x")
y = model.addVar(lb=0.2, ub=1.5, name="y")
z = model.addVar(lb=0.3, ub=2.8, name="z")

# Add constraints
model.addConstr(1.5*x + 1.2*y + 1.8*z <= 2.6)
model.addConstr(0.8*x + 0.6*y + 0.9*z >= 1.2)

# Set objective function
model.setObjective(1.2*x + 1.8*y + 2.1*z, sense=COPT.MAXIMIZE)

# Set parameter
model.setParam(COPT.Param.TimeLimit, 10.0)

# Solve the model
model.solve()

# Analyze solution
if model.status == COPT.OPTIMAL:
    # Get objective value
    print("Objective value: {}".format(model.objval))
    allvars = model.getVars()

    # Get valiable solution
    print("Variable solution:")
    for var in allvars:
        print(" x[{0}]: {1}".format(var.index, var.x))

    # Get variable basis status
    print("Variable basis status:")
    for var in allvars:
        print(" x[{0}]: {1}".format(var.index, var.basis))

# Write MPS model, solution, basis and parameters files
model.write("lp_ex1.mps")
model.write("lp_ex1.sol")
model.write("lp_ex1.bas")
model.write("lp_ex1.par")
```

ç»“æœï¼š

![å¯¹å¶å•çº¯å½¢æ³•](/Users/xinyuanhe/Desktop/2021ç¾èµ›/æ¨¡å‹/æ¨¡å‹-è¿ç­¹å­¦-è§„åˆ’è®º-çº¿æ€§è§„åˆ’ã€hxyã€‘/å¯¹å¶å•çº¯å½¢æ³•.png)

#### 4.4 å†…ç‚¹æ³•(Interior Point Method)

##### 4.4.1 æ¦‚å¿µ

> 1984 å¹´ Karmarkar æå‡ºäº†ä¸€ä¸ªæ¯” Khanchian æ³•å¥½çš„å¤šé¡¹å¼æ—¶é—´ç®—æ³•çš„å†…ç‚¹æ³•, ç§°ä¸º Karmarkar æ³•ã€‚ç”±äºè¯¥æ³•å¼•ç”¨äº†éçº¿æ€§è§„åˆ’ä¸­çš„ç‰›é¡¿æŠ•å½±, å› æ­¤åˆç§° Karmarkar æŠ•å½±æ³•ã€‚Karmarkar æ³•çš„æå‡ºåœ¨çº¿æ€§è§„åˆ’é¢†åŸŸå…·æœ‰æå¤§çš„ç†è®ºæ„ä¹‰ã€‚ä¸æ¤­çƒæ³•ä¸åŒ, è¿™ä¸ªæ–°ç®—æ³•ä¸ä»…åœ¨æœ€åæƒ…å†µä¸‹åœ¨æ—¶é—´å¤æ‚åº¦ä¸Šä¼˜äºå•çº¯å½¢æ³•, åœ¨å¤§å‹å®é™…é—®é¢˜ä¸­ä¹Ÿæœ‰æ½œåŠ›ä¸å•çº¯å½¢æ³•ç«äº‰ã€‚è¿™ä¸€æ–¹æ³•çš„æå‡ºæ€èµ·äº†ä¸€è‚¡å†…ç‚¹æ³•çš„ç ”ç©¶çƒ­æ½®ã€‚é‰´äº Karmarkar æ³•çš„éš¾è¯»æ€§, ä¸€äº›ç ”ç©¶å­¦è€…å¯¹ Karmarkar æ³•è¿›è¡Œäº†é€‚åº¦çš„ä¿®æ”¹, ä½¿å…¶ç®€ä¾¿æ˜“è¯»ã€‚ç„¶è€Œç›´æ¥ç”¨è¯¥æ–¹æ³•ç¼–ç¨‹è§£é¢˜çš„æµ‹è¯•è¡¨æ˜, ä¸ç›®å‰åŸºäºå•çº¯å½¢æ³•çš„å•†ç”¨è½¯ä»¶ç›¸æ¯”, å¹¶æ²¡æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚

##### 4.4.2 æ­¥éª¤ 

##### 4.4.3 å®ä¾‹ 

##### 4.4.4 ä»£ç å®ç° 

ç®€è¿°ï¼š**COPTçš„Pythonæ¥å£**ï¼Œä»**MPSæ¨¡å‹æ–‡ä»¶**æˆ–**LPæ ¼å¼æ¨¡å‹æ–‡ä»¶**ä¸­è¯»å–ï¼Œæ‰‹åŠ¨è®¾ç½®æ±‚è§£æ—¶é—´ï¼Œ**å†…ç‚¹æ³•**æ±‚è§£**LP**é—®é¢˜ï¼Œå¹¶å°†æ±‚è§£è¿‡ç¨‹è¾“å…¥æ±‚è§£æ—¥å¿—

ä»£ç ï¼š

 [lp_in.py](lp_in.py) 

```python
'''
The problem is read from:
    /Applications/copt30/examples/python/lp_ex1.mps
'''

# Import the Python interface library
from coptpy import *

# Create COPT environment
env = Envr()

# Create COPT model
model = env.createModel("lp_ex1")

# Read MPS model
model.read("lp_ex1.mps")

# Set log file
m.setLogFile("lp_ex1.log")

# Set parameter
m.setParam(COPT.Param.TimeLimit, 10.0)

# Set solving methos to Barrier
m.setParam(COPT.Param.LpMethod, 2)

# Solve the model
model.solve()

# Analyze solution
if model.status == COPT.OPTIMAL:
    # Get objective value
    print("Objective value: {}".format(model.objval))
    allvars = model.getVars()

    # Get valiable solution
    print("Variable solution:")
    for var in allvars:
        print(" x[{0}]: {1}".format(var.index, var.x))

    # Get variable basis status
    print("Variable basis status:")
    for var in allvars:
        print(" x[{0}]: {1}".format(var.index, var.basis))

# Write MPS model, solution, basis and parameters files
model.write("lp_ex1.mps")
model.write("lp_ex1.sol")
model.write("lp_ex1.bas")
model.write("lp_ex1.par")
```

ç»“æœï¼š

![å†…ç‚¹æ³•1](/Users/xinyuanhe/Desktop/2021ç¾èµ›/æ¨¡å‹/æ¨¡å‹-è¿ç­¹å­¦-è§„åˆ’è®º-çº¿æ€§è§„åˆ’ã€hxyã€‘/å†…ç‚¹æ³•1.png)

![å†…ç‚¹æ³•2](/Users/xinyuanhe/Desktop/2021ç¾èµ›/æ¨¡å‹/æ¨¡å‹-è¿ç­¹å­¦-è§„åˆ’è®º-çº¿æ€§è§„åˆ’ã€hxyã€‘/å†…ç‚¹æ³•2.png)

### 5. è¡¥å……èµ„æ–™

1. [æ•°æ¨¡å®˜ç½‘ - çº¿æ€§è§„åˆ’](https://anl.sjtu.edu.cn/mcm/docs/1%E6%A8%A1%E5%9E%8B/1%E8%BF%90%E7%AD%B9%E5%AD%A6/1%E8%A7%84%E5%88%92%E8%AE%BA/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/doc#28-%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E7%9A%84%E5%AF%B9%E5%81%B6)
2. qqå°ç¾¤ - åŸ¹è®­èµ„æ–™ - â€œ15-ç„¦ç²ç²-COPTæ±‚è§£å™¨ä½¿ç”¨æ•™ç¨‹.pdfâ€ - p56ï½p71
3. 1216 - æ¯æ—¥æ¨é€
4. [å•çº¯å½¢æ³•](https://blog.csdn.net/qq_36558948/article/details/80640768)
5. æ•™æ è¿ç­¹å­¦----ç¬¬ä¸‰ç‰ˆ .pdf
6. [GitHub----çº¿æ€§è§„åˆ’-å•çº¯å½¢ç®—æ³•](https://github.com/privateEye-zzy/simplex)
7. [çŸ©é˜µå•çº¯æ€§æ³•](https://wenku.baidu.com/view/92a40247f011f18583d049649b6648d7c1c708dc.html)



