[TOC] 

### 模型-评价主题-打分式评价-模糊综合评价【hxy】

#### 1. 模型名称

模糊综合评价法（Fuzzy Comprehension Evaluation Method，FCE）

#### 2. 适用范围

根据**多个定性评价**，转化为**定量评价**，对事物作出一个总体的评价

- **一级模糊综合评价**：考核指标个数较少时
- **多层次模糊综合评价**：考核指标个数较多时

#### 3. 形式

多个**定性指标**，多个**评价值**

#### 4. 求解过程

##### 4.1 步骤

###### 4.1.1 一级模糊综合评价

1. 确定**因素集$U$**
   $$
   U = \{u_1, u_2, ... , u_n\}
   $$

2. 确定**评语集$V$**
   $$
   V = \{v_1, v_2, ... , v_m\}
   $$

3. 确定**各因素的权重$A$**

   **Delphi法**，**加权平均法**，**众人评估法**等
   $$
   A = [a_1,a_2,...,a_n] \; with \; \sum_{i=1}^n a_i = 1
   $$

4. 确定**模糊综合判断矩阵$R$**
   $$
   R_i = [r_{i1},r_{i2},...,r_{im}] \\
   R = 
    \begin{bmatrix}
      r_{11} & r_{12} & ... & r_{1m}\\
      r_{21} & r_{22} & ... & r_{2m} \\
      ··· & ···& ··· & ···  \\
      r_{n1} & r_{n2} & ... & r_{nm} \\
     \end{bmatrix}
   $$

5. 得到**综合评判结果$B$**
   $$
   B = A · R = [b_1, b_2, ... , b_m]
   $$
   根据**最大隶属度原则**，取$b_1$到$b_m$中数值最大的对应的评语作为综合评判结果

###### 4.1.2 多层次模糊综合评价（以二级为例）

1. 确定**因素集$U$**
   $$
   U = \{u_1, u_2, ... , u_n\}
   $$

2. 将**因素集$U$**按某种属性分成$s$个**子因素集$U_1, U_2, ..., U_s$**
   $$
   U_i = \{u_{i1}, u_{i2}, ... , u_{in}\} \quad i = 1,2,...,s \\
   with \; n_1+n_2+...+n_s = n; \; U_1 \cup U_2 \;\cup ... \cup \;U_s = U; \; \forall i \neq j, \; U_i \cap U_j = \Phi
   $$

3. 对每一个**因素集$U_i$**作出**综合评判$B_i$**

   a) **评语集$V$**
   $$
   V = \{v_1, v_2, ... , v_m\}
   $$
   b) $U_i$中各因素相对于$V$的**权重分配$A$**
   $$
   A = [a_{i1},a_{i2},...,a_{in}]
   $$
   c) 若$\widetilde R_i$为**单因素评判矩阵**，得到**一级评判向量$B_i$**
   $$
   B_i = A_i · \widetilde R_i = [b_{i1}, b_{i2}, ... , b_{im}]\quad i = 1,2,...,s
   $$

4. 得到**单因素评判矩阵$R$**（推导过程见参考资料）
   $$
   R =
    \begin{bmatrix}
      B_1\\
      B_2 \\
      ··· \\
      B_s \\
     \end{bmatrix}
   =
    \begin{bmatrix}
      b_{11} & b_{12} & ... & b_{1m}\\
      b_{21} & b_{22} & ... & b_{2m} \\
      ··· & ···& ··· & ···  \\
      b_{s1} & b_{s2} & ... & b_{sm} \\
     \end{bmatrix}
   $$

5. 得到**二级评判向量$B$**
   $$
   B = A · R = [b_1, b_2, ... , b_m]
   $$
   根据**最大隶属度原则**，取$b_1$到$b_m$中数值最大的对应的评语作为综合评判结果

##### 4.2 实例

###### 4.2.1 一级模糊综合评价

某单位对员工做年终综合评定，评价指标为：政治表现（25%），工作能力（20%），工作态度（25%），工作成绩（30%），评价等级为：优秀，良好，一般，较差，差。其中政治表现由群众评议打分，10%的人认为政治表现优秀，50%的人认为政治表现良好，40的人认为政治表现一般；工作能力和工作态度由部门领导打分；工作成绩由单位考核组成员打分。打分汇总如下：

|          | 优秀 | 良好 | 一般 | 较差 | 差   |
| -------- | ---- | ---- | ---- | ---- | ---- |
| 政治表现 | 0.1  | 0.5  | 0.4  | 0    | 0    |
| 工作能力 | 0.2  | 0.5  | 0.2  | 0.1  | 0    |
| 工作态度 | 0.2  | 0.5  | 0.3  | 0    | 0    |
| 工作成绩 | 0.2  | 0.6  | 0.2  | 0    | 0    |

1. 确定**因素集$U$**
   $$
   U = \{政治表现u_1,工作能力u_2,工作态度u_3,工作成绩u_4\}
   $$

2. 确定**评语集$V$**
   $$
   V = \{优秀v_1, 良好v_2, 一般v_3, 较差v_4 , 差v_5\}
   $$

3. 确定**各因素的权重$A$**
   $$
   A = [0.25,0.20,0.25,0.30]
   $$

4. 确定**模糊综合判断矩阵$R$**
   $$
   R = 
    \begin{bmatrix}
      0.1 & 0.5 & 0.4 & 0 & 0\\
      0.2 & 0.5 & 0.2 & 0.1 & 0\\
      0.2 & 0.5 & 0.3 & 0 & 0\\
      0.2 & 0.6 & 0.2 & 0 & 0
     \end{bmatrix}
   $$

5. 得到**综合评判结果$B$**
   $$
   B = A · R  = 
   [0.25,0.20,0.25,0.30] ·  \begin{bmatrix}
      0.1 & 0.5 & 0.4 & 0 & 0\\
      0.2 & 0.5 & 0.2 & 0.1 & 0\\
      0.2 & 0.5 & 0.3 & 0 & 0\\
      0.2 & 0.6 & 0.2 & 0 & 0
     \end{bmatrix} \\
     = [0.175,0.53,0.275,0.02,0]
   $$
   由于$b_2 = 0.53$最大，根据**最大隶属度原则**，评判结果为“良好”

###### 4.2.2 多层次模糊综合评价（以二级为例）

评价指标为：工作绩效（40%），工作态度（30%），工作能力（20%），学习特长（10%）

| 一级指标 | 二级指标            | 优秀 | 良好 | 一般 | 较差 | 差   |
| -------- | ------------------- | ---- | ---- | ---- | ---- | ---- |
| 工作绩效 | 工作量（20%）       | 0.8  | 0.15 | 0.05 | 0    | 0    |
| 工作绩效 | 工作效率（30%）     | 0.2  | 0.6  | 0.1  | 0.1  | 0    |
| 工作绩效 | 工作质量（30%）     | 0.5  | 0.4  | 0.1  | 0    | 0    |
| 工作绩效 | 计划性（20%）       | 0.1  | 0.3  | 0.5  | 0.05 | 0.05 |
| 工作态度 | 责任感（30%）       | 0.3  | 0.5  | 0.15 | 0.05 | 0    |
| 工作态度 | 团队精神（20%）     | 0.2  | 0.2  | 0.4  | 0.1  | 0.1  |
| 工作态度 | 学习态度（10%）     | 0.4  | 0.4  | 0.1  | 0.1  | 0    |
| 工作态度 | 工作主动性（20%）   | 0.1  | 0.3  | 0.3  | 0.2  | 0.1  |
| 工作态度 | 满意度（20%）       | 0.3  | 0.2  | 0.2  | 0.2  | 0.1  |
| 工作能力 | 创新能力（10%）     | 0.1  | 0.3  | 0.5  | 0.1  | 0    |
| 工作能力 | 自我管理能力（20%） | 0.2  | 0.3  | 0.3  | 0.1  | 0.1  |
| 工作能力 | 沟通能力（30%）     | 0.2  | 0.3  | 0.35 | 0.15 | 0    |
| 工作能力 | 协调能力（20%）     | 0.1  | 0.3  | 0.4  | 0.1  | 0.1  |
| 工作能力 | 执行能力（20%）     | 0.1  | 0.4  | 0.3  | 0.1  | 0.1  |
| 学习特长 | 勤情评价（30%）     | 0.3  | 0.4  | 0.2  | 0.1  | 0    |
| 学习特长 | 技能提高（20%）     | 0.1  | 0.4  | 0.3  | 0.1  | 0.1  |
| 学习特长 | 培训参与（20%）     | 0.2  | 0.3  | 0.4  | 0.1  | 0    |
| 学习特长 | 工作提案（30%）     | 0.4  | 0.3  | 0.2  | 0.1  | 0    |

1. 确定**因素集$U$**
   $$
   U = \{工作量,工作效率,工作质量,计划性,责任感,团队精神,学习态度,工作主动性,满意度,\\创新能力,自我管理能力,沟通能力,协调能力,执行能力,勤情评价,技能提高,培训参与,工作提案\}
   $$

2. 将**因素集$U$**按某种属性分成$s$个**子因素集$U_1, U_2, U_3, U_4$**
   $$
   U_1 = \{工作量u_{11},工作效率 u_{12},工作质量 u_{13},计划性 u_{14}\} \\
   U_2 = \{责任感u_{21},团队精神 u_{22},学习态度 u_{23},工作主动性 u_{24}, 满意度u_{25}\} \\
   U_2 = \{创新能力u_{21},自我管理能力 u_{22},沟通能力u_{23},协调能力 u_{24}, 执行能力u_{25}\} \\
   U_4 = \{勤情评价u_{11},技能提高 u_{12},培训参与 u_{13},工作提案 u_{14}\} \\
   $$

3. 对每一个**因素集$U_i$**作出**综合评判$B_i$**

   a) **评语集$V$**
   $$
   V = \{优秀v_1, 良好v_2, 一般v_3, 较差v_4 , 差v_5\}
   $$
   b) $U_i$中各因素相对于$V$的**权重分配$A_i(i=1,2,3,4)$**
   $$
   A_1 = [0.2, 0.3, 0.3, 0.2] \\
   A_2 = [0.3, 0.2, 0.1, 0.2, 0.2] \\
   A_3 = [0.1, 0.2, 0.3, 0.2, 0.2] \\
   A_4 = [0.3, 0.2, 0.2, 0.3] \\
   $$
   c) 若$\widetilde R_i(i=1,2,3,4)$为**单因素评判矩阵**，得到**一级评判向量$B_i(i=1,2,3,4)$**
   $$
   B_1 = A_1 · \widetilde R_1  
   = [0.2, 0.3, 0.3, 0.2] · \begin{bmatrix}
      0.8 & 0.15 & 0.05 & 0 & 0\\
      0.2 & 0.6 & 0.1 & 0.1 & 0\\
      0.5 & 0.4 & 0.1 & 0 & 0\\
      0.1 & 0.3 & 0.5 & 0.05 & 0.05
     \end{bmatrix} \\ 
   = [b_{11}, b_{12}, ... , b_{15}]   = [0.39,0.39,0.26,0.04,0.01] \\
   B_2 = A_2 · \widetilde R_2 = [0.25,0.33,0.235,0.125,0.06] \\
   B_3 = A_3 · \widetilde R_3 = [0.15,0.32,0.355,0.115,0.06] \\
   B_4 = A_4 · \widetilde R_4 = [0.27,0.35,0.26,0.1,0.02] \\
   $$

4. 得到**单因素评判矩阵$R$**（推导过程见参考资料）
   $$
   R =
    \begin{bmatrix}
      B_1\\
      B_2 \\
      B_3 \\
      B_4 \\
     \end{bmatrix}
   =
      \begin{bmatrix}
      0.39&0.39&0.26&0.04&0.01\\
      0.25&0.33&0.235&0.125&0.06 \\
      0.15&0.32&0.355&0.115&0.06  \\
      0.27&0.35&0.26&0.1&0.02 \\
     \end{bmatrix}
   $$

5. 得到**二级评判向量$B$**
   $$
   A = [0.4,0.3,0.2,0.1] \\
   B = A · R =  [0.4,0.3,0.2,0.1] ·
   \begin{bmatrix}
      0.39&0.39&0.26&0.04&0.01\\
      0.25&0.33&0.235&0.125&0.06 \\
      0.15&0.32&0.355&0.115&0.06  \\
      0.27&0.35&0.26&0.1&0.02 \\
     \end{bmatrix}
   \\ = [0.288,0.354,0.2355,0.0865,0.036]
   $$
   由于$b_2 = 0.354$最大，根据**最大隶属度原则**，评判结果为良好

##### 4.3 代码实现

###### 4.3.1 一级模糊综合评价

 [Single.m](Single.m) 

代码：

```matlab
clc, clear
% Input original data
R = [0.1 0.5 0.4 0 0
0.2	0.5	0.2	0.1 0
0.2	0.5	0.3	0 0
0.2	0.6	0.2	0 0];
% Set the weighted allocation A
A = [0.25 0.2 0.25 0.3];
% Calculate the evaluation vector B
B = A * R;
```

结果：

<img src="/Users/xinyuanhe/Desktop/working/2021美赛/模型/模型-评价主题-打分式评价-模糊综合评价【hxy】/Single.png" alt="Single" style="zoom:50%;" />

###### 4.3.2 多层次模糊综合评价（以二级为例）

 [Multi.m](Multi.m) 

代码：

```matlab
clc, clear
% Input original data
r = [0.8 0.15 0.05 0 0
0.2	0.6	0.1	0.1	0
0.5	0.4	0.1	0 0
0.1	0.3	0.5	0.05 0.05
0.3	0.5	0.15 0.05 0
0.2	0.2	0.4	0.1	0.1
0.4	0.4	0.1	0.1	0
0.1	0.3	0.3	0.2	0.1
0.3	0.2	0.2	0.2	0.1
0.1	0.3	0.5	0.1	0
0.2	0.3	0.3	0.1	0.1
0.2	0.3	0.35 0.15 0
0.1	0.3	0.4	0.1	0.1
0.1	0.4	0.3	0.1	0.1
0.3	0.4	0.2	0.1	0
0.1	0.4	0.3	0.1	0.1
0.2	0.3	0.4	0.1	0
0.4	0.3	0.2	0.1	0];
% Set the First order weighted allocation A
A = [0.4 0.3 0.2 0.1];
% Set the Second order weighted allocation A1 to A4
A1 = [0.2 0.3 0.3 0.2];
A2 = [0.3 0.2 0.1 0.2 0.2];
A3 = [0.1 0.2 0.3 0.2 0.2];
A4 = [0.3 0.2 0.2 0.3];
% Calculate the Second order evaluation vector B1 to B4
R(1,:) = A1 * r((1:4),:);
R(2,:) = A2 * r((5:9),:);
R(3,:) = A3 * r((10:14),:);
R(4,:) = A4 * r((15:end),:);
% Calculate the First order evaluation vector B
B = A * R;
```

结果：

<img src="/Users/xinyuanhe/Desktop/working/2021美赛/模型/模型-评价主题-打分式评价-模糊综合评价【hxy】/Multi.png" alt="Multi" style="zoom:50%;" />

#### 5. 参考资料

1. 《数学建模算法与应用》P416-P420

