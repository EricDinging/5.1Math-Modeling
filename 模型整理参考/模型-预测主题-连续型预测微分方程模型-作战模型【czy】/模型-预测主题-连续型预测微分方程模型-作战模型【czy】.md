[TOC]

### 作战模型

#### 1. 适用范围

进行战争中两军兵力走向的预测以及战争结果的预测分析，并根据分析得出如何调整战略能取胜。

#### 2. 模型假设

**“兰彻斯特平方定律”**：作战部队的实力同投入战斗的战士人数的平方成正比。 

对于一次局部战斗，有些因素可以不考虑，如气候，后勤供应，士气的高低，而有些因素我们把双方看成是相同的，如武器配备，指挥艺术。还可简单地认为两军的战斗力完全取决于两军的士兵人数。两军士兵都处于对方火力范围内，由于战斗紧迫，短暂，也不考虑支援部队。

#### 3. 常见类型

##### 3.1 模型1（一般战斗模型）

###### 3.1.1 模型假设和参数说明

设想一下$x(t)$和$y(t)$表示甲乙交战双方时刻$t$的兵力，不妨视为双方的士兵人数，假设:

（1）每一方的战斗减员率取决于双方的兵力和战斗力，用$f(x,y)$和$g(x,y)$表示。

（2）每一方的非战斗减员率（由疾病、逃跑等因素引起）与本方的兵力成正比。

（3）每一方的增援率是给定的函数，用$u(t)$和$v(t)$表示。

###### 3.1.2 推导过程

由此可以写出关于$x(t)$和$y(t)$的微分方程为
$$
\frac{\mathrm{d}x}{\mathrm{d}t}=-f(x,y)-\alpha x+u(t),a>0
$$

$$
\frac{\mathrm{d}y}{\mathrm{d}t}=-g(x,y)-\beta y+v(t),b>0
$$

下面针对不同的战争类型讨论战斗减员率$f,g$的具体表示形式，并分析影响战争结局的因素。

##### 3.2 模型2（正规战模型）

###### 3.2.1 模型假设和参数说明

设想一下中世纪的欧洲战场或者第一次世界大战的战场：作战的双方摆好队型，堂堂正正开战。

我们假设： 甲乙双方都用正规部队作战，我们只须分析甲方的战斗减员率 $f(x,y)$。甲方士兵公开活动，处于乙方每一个士兵的监视和杀伤范围之内，一旦甲方某个士兵被杀伤，乙方的火力立即集中在其余士兵身上，所以甲方的战斗减员率只与乙方兵力有关，可以简单地设$f$与$y$成正比，即$f=ay$，$a$表示乙方平均每个士兵对甲方士兵的杀伤率（单位时间的杀伤数），称乙方的战斗有效系数，$a$可以进一步分解为$a=r_yp_y$，其中$r_y$是乙方的射击率（每个士兵单位时间的射击次数），$p_y$是每次射击的命中率。 类似地有$g=bx$，且甲方的战斗有效系数$b=r_xp_x$，$r_x$，$p_x$是甲方的射击率和命中率。

###### 3.2.2 推导过程

于是在这个模型中原方程化为
$$
\frac{ \mathrm{d}x}{\mathrm{d}t}=-ay-\alpha x+u(t)
$$

$$
\frac{ \mathrm{d}y}{\mathrm{d}t}=-by-\beta x+v(t)
$$

在分析战争结局时忽略非战斗减员一项（与战斗减员相比，这项很小），并且假设双方都没有增援，记双方的初始兵力分别是$x_0,y_0$，上式简化为
$$
\frac{\mathrm{d}x}{\mathrm{d}t}=-ay
$$

$$
\frac{\mathrm{d}y}{\mathrm{d}t}=-bx
$$

$$
x_{(0)}=x_0,y_{(0)}=y_0
$$

不直接求解方程，而在相平面上讨论相轨线的变化规律[^1]更容易判断双方的胜负，可得
$$
\frac{\mathrm{d}y}{\mathrm{d}x}=\frac{bx}{ay}
$$
###### 3.2.3 模型表达式

两边积分，解为
$$
ay^2-bx^2=k
$$
注意到正规战模型的初始条件，有
$$
k=ay_0^2-bx_0^2
$$
由解确定的相轨线是双曲线族，如右图 ，箭头表示随时间$t$的增加，$x(t)$,$y(t)$的变化趋势。

![屏幕截图 2022-01-24 104536](C:\Users\Lenovo\Desktop\屏幕截图 2022-01-24 104536.png)

###### 3.2.4 模型分析

可以看出，如果$k>0$，轨线将与$y$轨相交，这就是说存在$t_1$，使$x(t_1)=0,y(t_1)=\sqrt{\frac{k}{a}}>0$，即当甲方兵力为零时乙方兵力为正值，表明乙方获胜，同理可知，$k<0$时甲方获胜，而当$k=0$时双方战平。 

进一步分析某一方譬如乙方取胜的条件，由其初始条件式并注意到$a,b$的含义，乙方获胜的条件可表为
$$
(\frac{y_0}{x_0})^2>\frac{b}{a}=\frac{r_xp_x}{r_yp_y}
$$
上式说明双方初始兵力之比$y_0/x_0$以平方关系影响着战争的结局，例如若一方兵力增加到原来的两倍（甲方不变），则影响战争结局的能力增加到四倍，或者说，若甲方的战斗力譬如射击率$r_x$增加到原来的四倍（$p_x,r_y,p_y$均不变），那么为了与此相抗衡，乙方只须将初始兵力$y_0$增加到原来的二倍，由于这个原因正规战争模型称为**平方律模型**。

##### 3.3 模型3（游击战争模型）

###### 3.3.1 模型假设和参数说明

假设条件:双方都用游击部队作战。 甲方士兵在乙方士兵看不到的某个面积为$s_x$的隐蔽区域内活动，乙方士兵不是向甲方士兵开火，而是这个隐蔽区域射击，并且不知道杀伤情况，这时甲方战斗减员率不仅与乙方兵力有关，而且随着甲方兵力的增加而增加，因为在一个有限区域内，士兵越多，被杀伤的就越多，这样可以简单地假设$f=cxy$，且乙方战斗有效系数$c$可表为$c=r_yp_y=r_y=r_y\frac{s_{ry}}{s_x}$，其中$r_y$仍为射击率，而命中率$p_y$等于乙方一次射击的有效面积$s_{ry}$与甲方活动面积$s_x$之比。 类似地有$g=dxy, d=r_xp_x=r_x\frac{s_{rx}}{s_y}$ 。

###### 3.3.2 推导过程 

于是在这个模型中原方程化为
$$
\frac{\mathrm{d}x}{\mathrm{d}t}=-cxy-ax-u(t)\\

\frac{\mathrm{d}y}{\mathrm{d}t}=-dxy-by+v(t)
$$
忽略$ax,bx$并设$u=v=0$，在初始条件下上式为
$$
\frac{\mathrm{d}x}{\mathrm{d}t}=-cxy
$$

$$
\frac{\mathrm{d}y}{\mathrm{d}t}=-dxy
$$

$$
x_{(0)}=x_0,y_{(0)}=y_0
$$

###### 3.3.3 模型表达式

与正规战争模型中方程的解法类似，解为
$$
cy-dx=m\\
m=cy_0-dx_0
$$
![屏幕截图 2022-01-24 105609](C:\Users\Lenovo\Desktop\屏幕截图 2022-01-24 105609.png)

###### 3.3.4 模型分析

 其确定的相轨线是直线族，像分析正规战争模型一样，可知$m>0$时乙方胜，$m<0$时甲方胜，$m=0$时战平。

 乙方获胜的条件还可以表为
$$
\frac{y_0}{x_0}>\frac{d}{c}=\frac{r_xs_{rx}s_x}{r_ys_{ry}s_y}
$$

初始兵力之比$\frac{y_0}{x_0}$以线性关系影响战争结局，并且当射击率和射击有效面积一定时，增加活动面积$s_y$与增加初始兵力$y_0$起着相同的作用

这个模型又称**线性率模型**。

##### 3.4 模型4（混合战争模型）

###### 3.4.1 模型假设和参数说明

甲方游击部队，乙方正规部队

根据对正规战和游击战模型的分析假设，$f=cxy,g=bx$

###### 3.4.2 推导过程 

在相同的忽略和假设下方程为
$$
\frac{\mathrm{d}x}{\mathrm{d}t}=-cxy\\

\frac{\mathrm{d}y}{\mathrm{d}t}=-bx\\
x(0)=x_0,y(0)=y_0
$$

###### 3.4.3 模型表达式

它的轨线
$$
cy^2-2bx=n\\
n=cy_0^2-2bx_0
$$
![屏幕截图 2022-01-24 111213](C:\Users\Lenovo\Desktop\屏幕截图 2022-01-24 111213.png)

###### 3.4.4 模型分析 

由图，可知$n>0$时乙方胜，$n<0$时甲方胜，$n=0$时战平。并且乙方(正规部队)获胜的条件为：
$$
(\frac{y_0}{x_0})^2>\frac{2b}{cx_0}=\frac{2r_xp_xs_x}{r_ys_{ry}x_0}
$$

#### 4. 实例 

**硫磺岛战役**

##### 4.1 问题描述

美日战争，日军21500人全部阵亡或被俘，美军投入兵力73000人，伤亡20265人。日军没有增援。战斗持续36天。已知条件有美军战地记录给出的增援率$u(t)$为
$$
u(t):\begin{cases}  
54,000&0\leq t <1\\  
6,000 &2\leq t <3 \\13,000 &5\leq t <6\\0&其他
\end{cases}
$$
已知美军每天的兵力A(t)(图中虚线)，请对美军A(t)建立合适的数学模型

##### 4.2 解题过程

用$A(t),J(t)$表示美军和日军第$t$天的人数，在**正规战模型**中忽略非战斗减员，且$v=0,$再添加初始条件，有
$$
(1)：\begin{cases}  
\frac{\mathrm{d}A}{\mathrm{d}t}=-aJ(t)+u(t)\\
\frac{\mathrm{d}J}{\mathrm{d}t}=-bA(t)\\
A(0)=0,J(0)=21500
\end{cases}
$$


并可由每天的伤亡人数算出$A(t)$,其中$t=1,2,...,36$(见图中虚线)。下面用这些实际数据代入(1)式，算出A(t)的理论值，并与实际值比较

对(1)式用求和代替积分可得：
$$
A(t)=A(0)-a\sum _{\tau=1}^tJ(\tau)+\sum _{\tau=1}^tu(\tau) ----(1)\\
J(t)=J(0)-b\sum _{\tau=1}^tA(\tau) ----(2)
$$
由题意得$J(36)=0$,$\sum _{\tau=1}^{36}A(\tau)=2,037,000$,

由(2)估算得
$$
b=\frac{21,500}{2,037,00}=0.0106
$$
再代回(2),算出J(t),t=1,2,...,36。然后(1)式估计$a$,令$t=36,$得
$$
a=\frac{\sum _{\tau=0}^{36}u(\tau)-A(36)}{\sum _{\tau=0}^{36}J(\tau)}=\frac{20,265}{372,500}=0.0544
$$
代回(1)式得美军人数$A(t)$的理论值，与虚线的实际相比，分析吻合情况
$$
A(t)=-0.0544\sum _{\tau=1}^tJ(\tau)+\sum _{\tau=1}^tu(\tau)
$$
![屏幕截图 2022-01-24 111839](C:\Users\Lenovo\Desktop\屏幕截图 2022-01-24 111839.png)

#### 5. 代码实现

##### 5.1 战斗模型在matlab的实现 示例一

~~~matlab
function regular_battle()
x = [35,30,25,20,15,10,5];
y = 20;
for s = x
   if s >= y
       [k,a,b] = unidimensionalCompute(s,y);
       t1 = 0.0:0.05:20.0;
       m = getY(t1,k,a,b);
       plot(m,t1);
       hold on;
   else
       k = unidimensionalCompute(s,y);
       t1 = 0.0:0.05:20.0;
       m = getX(t1,k,a,b);%这里的getX部分其实和getY部分都是相同的只是多做一个简单的封装
       plot(t1,m);
       hold on;
   end
grid on
xlabel('y(t)');
ylabel('x(t)');
title("regular warfare model")

function [re,a,b] = unidimensionalCompute(x0,y0)
rx =0.5;
px = 0.6;
ry = 0.75;
py = 0.4;
a = rx*px; %乙方平均每个士兵对甲方士兵的杀伤率（单位时间的杀伤数）
b = ry*py;%甲方平均每个士兵对乙方士兵的杀伤率（单位时间的杀伤数）
%regular warfare(正规战争，不考虑后勤人员之类的，只关注双方的人数和战斗力)
%本代码中只通过调整具体的双方人数来作图，当然你也可以通过改变a,b来作图
re = a*y0*y0-b*x0*x0;%根据双方的初始人数来得到我们的常量k
 
end     

~~~

##### 5.2 战斗模型在python的实现 示例二

~~~python
#################################################  
# kmeans: battle model
# MCM2018 Python3.5代码模板 SJTU 
# By:Tan xiao
#################################################
# 可能需要根据实际情况更改的部分和注意事项：
# 1.本代码一共有两个部分，一个部分是正规战争，一个部分是游击战争
# 2.数据输入部分，要有相应的格式,我们直接才用我们直接才用input的方式
# 3.可视化部分比较简略
# 4.可视化部分的具体细节根据个人需求而定
# 5.我们的模型是按照最简单的情况来的，对于具体的题目来讲，本题目当中出现的常数必然是可以有其他的内容（函数）的添加
################################################

##导入库
import numpy as np
import time
import matplotlib.pyplot as plt
#部分常量的定义
x = [35,30,25,20,15,10,5]
y = 20
rx =0.5
px = 0.6
ry = 0.75
py = 0.4
a = rx*px #乙方平均每个士兵对甲方士兵的杀伤率（单位时间的杀伤数）
b = ry*py #甲方平均每个士兵对乙方士兵的杀伤率（单位时间的杀伤数）
#regular warfare(正规战争，不考虑后勤人员之类的，只关注双方的人数和战斗力)
#本代码中只通过调整具体的双方人数来作图，当然你也可以通过改变a,b来作图
def unidimensionalCompute(x0,y0):
    k = a*y0*y0-b*x0*x0
    return k#根据双方的初始人数来得到我们的常量k，k=0则我们双方战成平局，k>0则甲方胜，k<0则乙方胜
def getY(i,k):
    return np.sqrt((abs(k)+a*i*i)/b)
def getX(i,k):
    return np.sqrt((abs(k)+a*i*i)/b)
def unidimensionalPlot():
    for s in x:
        if s >= y:
            k = unidimensionalCompute(s,y)
            t1 = np.arange(0.0, 20.0, 0.05)#设置一个0到30的考察范围
            plt.plot(t1, getY(t1,k), 'k')
        else:
            k = unidimensionalCompute(s,y)
            t1 = np.arange(0.0,20.0,0.05)
            plt.plot(getX(t1,k),t1,'k')
    plt.title("regular warfare model")
    plt.ylabel("y(t)")
    plt.xlabel("x(t)")
    plt.show()
def main1():
    unidimensionalPlot()
#if __name__ == "__main__":
#    main1()
#下述代码是游击战
###############
Sry = 0.1#乙方一次射击的有效面积
Srx = 0.2#乙方一次射击的有效面积
Sx = 0.15#甲方活动面积
Sy = 0.10#乙方的活动面积
c = ry*Sry/Sx#ry为命中率，本来该使用命中率，我们游击战中命中率为有效面积Sry与甲方活动面积之比Sx,同理甲方也是一样
d = rx*Srx/Sy#按照c站在甲方的角度理解即可
def ReturnM(x0,y0):
    return c*y0-d*x0;
def returnY(m,x1):
    return (m+d*x1)/c
def Plot():
    for s in x:
        m = ReturnM(s,y)
        t1 = np.arange(0.0, 20.0, 0.05)#设置一个0到30的考察范围
        plt.plot(t1, returnY(m,t1), 'k')
    plt.title("guerrilla warfare model")
    plt.ylabel("y(t)")
    plt.xlabel("x(t)")
    plt.show()
def main2():
    Plot()
if __name__ == "__main__":
    main2()#注意如过想看正规战争的话，需要把这里的main2改为main1
~~~

#### 6. 参考资料

1.  [数学建模培训营----作战模型](https://anl.sjtu.edu.cn/mcm/docs/1%E6%A8%A1%E5%9E%8B/7%E9%A2%84%E6%B5%8B%E4%B8%BB%E9%A2%98/3%E8%BF%9E%E7%BB%AD%E5%9E%8B%E9%A2%84%E6%B5%8B%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B/%E4%BD%9C%E6%88%98%E6%A8%A1%E5%9E%8B/doc)
2.  [数学模型----正规战与游击战](https://wenku.baidu.com/view/5eeacc8933d4b14e852468b8.html)
3.  [一类非线性兰彻斯特方程的相轨线分析](https://www.docin.com/p-1382583866.html)

[^1]: 对于二维情形，若微分方程$\frac{dx}{dt}=P(t,x,y),\frac{dy}{dt}=Q(t,x,y)$满足初始条件$x(t_0)=x_0,y(t_0)=y_0$ 的解为$x=x(t)，y=y(t)$ 则该组解在$xOy$平面上(相平面)所描绘的曲线就是相轨线。通俗解释，若有两个变量$x(t),y(t)$，绘出的y(x)曲线就是相轨线

 