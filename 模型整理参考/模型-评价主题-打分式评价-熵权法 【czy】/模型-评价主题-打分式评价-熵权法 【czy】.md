[TOC]

### 模型-评价主题-打分式评价-熵权法 【czy】

#### 1. 模型名称

熵权法（Entropy Weight Method，EWM） 

#### 2. 适用范围

多属性决策问题

常见应用场景：一般在需要确定每个因素对总体影响的权重的过程中使用，可和很多模型方法结合使用。

**熵权法与层次分析法（AHP）的比较**

- 熵权法
  - 优点
    - 客观性（相对于主观赋值法）
    - 适应性（用于任何确定权重的过程，也可以结合其它方法)
  - 缺点
    - 目前只在确定权重的过程中使用，所以使用范围有限
- 层次分析法
  - 优点
    - 系统性的分析方法
    - 简洁实用的决策方法，所需定量数据信息较少
  - 不能为决策提供新方案，定量数据上，定性成分多

#### 3. 形式

$n$个评价对象，$m$个评价指标。

#### 4. 求解过程

##### 4.1 概念

​		熵权法的基本思路是根据指标变异性的大小来确定客观权重。一般来说，若某个指标的信息熵$e_j$越小，表明指标值得变异程度越大，提供的信息量越多，在综合评价中所能起到的作用也越大，其权重也就越大。

##### 4.2 步骤

1. 第$i$个评价对象对于第$j$个指标变量的取值为$a_{ij}$,($i=1,2,...,n;j=1,2,...,m$),构造数据矩阵$A=(a_{ij})_{n\times m}$
2. 利用原始数据矩阵$A=(a_{ij})_{n\times m}$计算$p_{ij}$,即第$i$个评价对象关于第$j$个指标值的比重：

$$
p_{ij}=\frac{a_{ij}}{\sum_{i=1}^na_{ij}}
$$
3. 计算第$j$项指标的熵值：
   $$
   e_j=-\frac{1}{\ln n}\sum_{i=1}^np_{ij}\ln p_{ij}
   $$

4. 计算第$j$项指标的变异系数：
   $$
   g_j=1-e_j
   $$
   对于第$j$项指标，$e_j$越大，指标值的变异程度越小。

5. 计算第$j$项指标的权重：
   $$
   w_j=\frac{g_j}{\sum_{j=1}^mg_{j}}
   $$

6. 计算第$i$个评价对象的综合评价值：
   $$
   s_i=\sum_{j=1}^mw_{j}p_{ij}
   $$
   评价值越大越好

##### 4.3 实例与代码实现

###### 4.3.1 例一

1. 题目：根据表14.20给出的10个学生8门课的成绩，给出这10个人评奖学金的评分排序

   ​                                                      表14.20    学生成绩表

   | 学生编号 | 语   | 数   | 物   | 化   | 英   | 政   | 生   | 史   |
   | -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
   | 1        | 93   | 66   | 86   | 88   | 77   | 71   | 90   | 94   |
   | 2        | 97   | 99   | 61   | 61   | 75   | 87   | 70   | 70   |
   | 3        | 65   | 99   | 94   | 71   | 91   | 86   | 80   | 93   |
   | 4        | 97   | 79   | 98   | 61   | 92   | 66   | 88   | 69   |
   | 5        | 85   | 92   | 87   | 63   | 67   | 64   | 96   | 98   |
   | 6        | 63   | 65   | 91   | 93   | 80   | 80   | 99   | 74   |
   | 7        | 71   | 77   | 90   | 88   | 78   | 99   | 82   | 68   |
   | 8        | 82   | 97   | 76   | 73   | 86   | 73   | 65   | 70   |
   | 9        | 99   | 92   | 86   | 98   | 89   | 83   | 66   | 85   |
   | 10       | 99   | 99   | 67   | 61   | 90   | 69   | 70   | 79   |

   指标变量$x1,x2,...,x8$分别表示其语数物...史成绩

   2. 解法

      利用Matlab程序，求得各项指标的权重见表14.21，各学生的评价值及排名次序见表14.22。

   各学生的评价值从高到低的次序是：9 1 3 7 6 5 4 10 8 2

   ​                                      

   ​                                                     表14.21     各指标的评价权重

   | 指标 | $x_1$  | $x_2$  | $x_3$  | $x_4$  | $x_5$  | $x_6$  | $x_7$  | $x_8$  |
   | ---- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
   | 权重 | 0.1544 | 0.1363 | 0.1127 | 0.1972 | 0.0552 | 0.1064 | 0.1273 | 0.1104 |

   ​                                              表14.22      学生的综合评价及排名次序

   | 学生编号    | 1      | 2      | 3      | 4      | 5      | 6      | 7      | 8      | 9      | 10     |
   | ----------- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
   | 评价值$s_i$ | 0.1039 | 0.0950 | 0.1019 | 0.0978 | 0.1000 | 0.1003 | 0.1012 | 0.0951 | 0.1091 | 0.0959 |
   | 排名        | 2      | 10     | 3      | 7      | 6      | 5      | 4      | 9      | 1      | 8      |

   3. Matlab代码实现

      ~~~
      clc,clear
      a=readmatrix('data14_9_1.txt');
      [n,m]=size(a);
      p=a./sum(a);
      e=-sum(p.*log(p))/log(n);
      g=1-e;w=g/sum(g)                      %计算权重
      s=w*p'                                %计算各个评价对象的综合评价值
      [ss,ind1]=sort(s,'descend')           %对评价值从大到小排序
      ind2(ind1)=1:n                        %学生编号对应的排序位置
      writematrix(w,'data14_9_2.xlsx')      %把数据写到Excel文件的表单1
      writematrix([1:n;s;ind2],'data14_9_2.xlsx','Sheet',2) %把数据写在表单2
      ~~~

      

###### 4.3.2 例二

1. 题目：医院对11个科室进行考核，有9个指标$x_1,x_2,...,x_9$。

   | 科室 | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $x_9$ |
   | ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
   | A    | 100   | 90    | 100   | 84    | 90    | 100   | 100   | 100   | 100   |
   | B    | 100   | 100   | 78.6  | 100   | 90    | 100   | 100   | 100   | 100   |
   | C    | 75    | 100   | 85.7  | 100   | 90    | 100   | 100   | 100   | 100   |
   | D    | 100   | 100   | 78.6  | 100   | 90    | 100   | 94.4  | 100   | 10    |
   | E    | 100   | 90    | 100   | 100   | 100   | 90    | 100   | 100   | 8     |
   | F    | 100   | 100   | 100   | 100   | 90    | 100   | 100   | 85.7  | 10    |
   | G    | 100   | 100   | 78.6  | 100   | 90    | 100   | 55.6  | 100   | 100   |
   | H    | 87.5  | 100   | 85.7  | 100   | 100   | 100   | 100   | 100   | 100   |
   | I    | 100   | 100   | 92.9  | 100   | 80    | 100   | 100   | 100   | 100   |
   | J    | 100   | 90    | 100   | 100   | 100   | 100   | 100   | 100   | 100   |
   | K    | 100   | 100   | 92.9  | 100   | 90    | 100   | 100   | 100   | 100   |

   由于各项指标难易程度不同，需要对9项指标进行赋权

   根据信息熵$e_j$的计算公式,求得信息熵如下：

   |        | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $x_9$ |
   | ------ | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
   | 信息熵 | 0.95  | 0.87  | 0.84  | 0.96  | 0.94  | 0.96  | 0.96  | 0.96  | 0.96  |

   根据权重$w_j$的计算公式，求得各个指标的权重如下：

   |      | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $x_9$ |
   | ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
   | 权重 | 0.08  | 0.22  | 0.27  | 0.07  | 0.11  | 0.07  | 0.07  | 0.07  | 0.07  |

   对各科室进行评分，得分如下：

   | 科室 | A     | B     | C     | D     | E     | F     | G     | H     | I     | J     | K     |
   | ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
   | 得分 | 95.71 | 93.14 | 93.17 | 92.77 | 95.84 | 98.01 | 90.21 | 95.17 | 95.57 | 97.81 | 97.02 |

   2. 代码实现

      ~~~
      function weights = EntropyWeight(R)
      %% 熵权法求指标权重,R为输入矩阵,返回权重向量weights
      
      [rows,cols]=size(R);   % 输入矩阵的大小,rows为对象个数，cols为指标个数
      k=1/log(rows);         % 求k
      
      f=zeros(rows,cols);    % 初始化fij
      sumBycols=sum(R,1);    % 输入矩阵的每一列之和(结果为一个1*cols的行向量)
      % 计算fij
      for i=1:rows
          for j=1:cols
              f(i,j)=R(i,j)./sumBycols(1,j);
          end
      end
      
      lnfij=zeros(rows,cols);  % 初始化lnfij
      % 计算lnfij
      for i=1:rows
          for j=1:cols
              if f(i,j)==0            lnfij(i,j)=0;
              else
                  lnfij(i,j)=log(f(i,j));
              end
          end
      end
      
      Hj=-k*(sum(f.*lnfij,1)); % 计算熵值Hj
      weights=(1-Hj)/(cols-sum(Hj));
      end
      ~~~

      ~~~
      import numpy as np
      for i in range(10):
          print('hello world')
      ~~~

#### 5.参考资料

1. 《数学建模算法与应用》 P432~P434（主要）

2. [熵权法确定权重----知乎](https://zhuanlan.zhihu.com/p/28067337)（辅助）