[TOC]

### 模型-评价主题-打分式评价-理想解法  TOPSIS【czy】

#### 1. 模型名称

理想解法(Technique for Order Preference by Similarity to an Ideal Solution,TOPSIS)

#### 2. 适用范围

多属性决策问题   

#### 3. 形式

$m$个评价对象，$n$个评价指标。

#### 4. 求解方法

##### 4.1 概念

设多属性决策方案集为**D**={$d_1$,$d_2$,...,$d_m$},

衡量方案优劣的属性变量为$x_1,x_2,...,x_n$,

通过构造评价问题的正理想解$C^*$[^1]和负理想解$C^0$，即各指标的最优解和最劣解，将$D$中的各方案$d_i$与$C^*$和$C^0$的距离进行比较，既靠近正理想解又远离负理想解的方案就是方案集**D**中的最优方案；并可以据此排定方案集**D**中各方案的优先序。

##### 4.2 步骤

1. 列出决策矩阵$A=(a_{ij})_{m\times n}$

2. 属性规范化，求出规范化决策矩阵:$B=(b_{ij})_{m\times n}$

   * 方法一：线性变换

     原始决策矩阵为$A=(a_{ij})_{m \times n}$,变换后的矩阵为$B=(b_{ij})_{m \times n}$,$i=1,2,...,m$;$j=1,2,...,n$。

     设$a_j^{min}$是决策矩阵第$j$列中的最小值，$a_j^{max}$是决策矩阵第$j$列中的最大值。

     若$x_j$为效益性属性，则
     $$
     b_{ij}=a_{ij}/a_j^{max}
     $$
     上述变化后，最差属性值不一定为0，最优属性值为1。

     若$x_j$为成本型属性，则
     $$
     b_{ij}=1-a_{ij}/a_j^{max}
     $$
     上述变化后，最优属性值不一定为1，最差属性值为0。

   * 方法二：标准0-1变化

     好处：使每个属性变换后最优值为1，最差值为0

     若$x_j$为效益型属性，则
     $$
     b_{ij}=\frac{a_{ij}-a_j^{min}}{a_j^{max}-a_j^{min}}
     $$
     若$x_j$为成本型属性，则
     $$
     b_{ij}=\frac{a_j^{max}-a_{ij}}{a_j^{max}-a_j^{min}}
     $$

   * 方法三：区间型属性的变换

     设给定的最优属性区间为$[a_j^0,a_j^*]$,$a_j^{'}$为无法容忍下限，$a_j^{"}$为无法容忍上限。
     $$
     b_{ij}=\begin{cases}
     1-(a_j^0-a_{ij})/(a_j^0-a_j^{'}),&&a_j^{'}\leq a_{ij}\le{a_j^0} \\
     1,&&a_j^0\leq a_{ij}\le{a_j^*}\\
     1-(a_{ij}-a_j^*)/(a_j^{"}-a_j^*),&&a_j^*< a_{ij}\le{a_j^{"}}\\
     0,&&其他.
     \end{cases}
     $$

   * 方法四：向量规范化

     范围：无论是成本型变量还是效益型变量
     $$
     b_{ij}=a_{ij}/\sqrt{\sum_{i=1}^ma_{ij}^2},i=1,2,...,m;j=1,2,...,n
     $$
     变换后各方案的同一属性值的平方和为1，因此常用于计算各方案与各种虚拟方案（如正负理想点）的欧几里得距离。

     但变化后属性值的大小上无法分辨属性值的优劣。

   * 方法五：标准化处理

     目的：实际问题中不同变量有不同的测量单位。为了消除变量的量纲效应
     $$
     b_{ij}=\frac{a_{ij}-\mu_j}{s_j},i=1,2,...,m,j=1,2,...,n, 
     $$
     式中：$\mu_j=\frac{1}{m} \sum_{i=1}^ma_{ij}$,$s_j=\sqrt{\frac{1}{m-1} \sum_{i=1}^m{(a_{ij}-\mu_j)^2}}$,$j$=1,2,...,n。

3.  构造加权规范矩阵$C=(c_{ij})_{m\times n}$。设决策人给定各属性的权重向量为$w=[w_1,w_2,...,w_n]^T$，则
   $$
   c_{ij}=w_j·b_{ij}
   $$

4. 确定正理想解和负理想解。$j=1,2,...,n$。
   $$
   正理想解：c_j^*=\begin{cases}
   \max_i{c_{ij}},j为效益型属性 \\
   \min_i{c_{ij}},j为成本型属性
   \end{cases}
   $$

   $$
   负理想解：c_j^0=\begin{cases}\min_i{c_{ij}},j为效益型属性 \\\max_i{c_{ij}},j为成本型属性\end{cases}
   $$

5. 计算各方案到正理想解和负理想解的距离。

   备选方案$d_i$到正理想解之间的距离为
   $$
   s_i^0=\sqrt{\sum_{j=1}^n(c_{ij}-c_j^0)^2},i=1,2,...,m;
   $$
   备选方案$d_i$到负理想解之间的距离为
   $$
   s_i^0=\sqrt{\sum_{j=1}^n(c_{ij}-c_j^0)^2},i=1,2,...,m;
   $$

6.  计算各方案的排序指标值（即综合评价指数），即
   $$
   f_i^*=s_i^0/(s_i^0+s_i^*),i=1,2,...,m
   $$
   
7. 按$f_i^*$由大到小排列方案的优劣次序

##### 4.3 例子

对研究生院进行评估，下面资料给出5所研究生院关于4个方面的数据

表14.1：

|      | 人均专著 $x_1$  /  (本/人) | 生师比 $x_2$ | 科研经费$x_3$/（万元/年） | 逾期毕业率$x_4$/% |
| ---- | -------------------------- | ------------ | ------------------------- | ----------------- |
| 1    | 0.1                        | 5            | 5000                      | 4.7               |
| 2    | 0.2                        | 6            | 6000                      | 5.6               |
| 3    | 0.4                        | 7            | 7000                      | 6.7               |
| 4    | 0.9                        | 10           | 10000                     | 2.3               |
| 5    | 1.2                        | 2            | 400                       | 1.8               |

1. 第一步：

对表14.1中属性2的数据进行最优值为**给定区间的变换**[^2]：使用方法三。

属性2的数据处理表14.2如下

​                                                表14.2  表14.1的属性2的数据处理

|      | 生师比 $x_2$ | 处理后的生师比 |
| ---- | ------------ | -------------- |
| 1    | 5            | 1              |
| 2    | 6            | 1              |
| 3    | 7            | 0.8333         |
| 4    | 10           | 0.3333         |
| 5    | 2            | 0              |

然后对属性值进行**向量规范化**:使用方法四，结果如下表14.4

​                                                 表14.4  表14.1的数据经规范化后的属性值

|      | 人均专著 | 生师比 | 科研经费 | 逾期毕业率 |
| ---- | -------- | ------ | -------- | ---------- |
| 1    | 0.0638   | 0.597  | 0.3449   | 0.4546     |
| 2    | 0.1275   | 0.597  | 0.4139   | 0.5417     |
| 3    | 0.2550   | 0.4975 | 0.4829   | 0.6481     |
| 4    | 0.5738   | 0.199  | 0.6898   | 0.2225     |
| 5    | 0.7631   | 0      | 0.0276   | 0.1741     |

2. 第二步：

设权向量为$w=[0.2,0.3,0.4,0.1]$,得加权的向量规范化属性矩阵见表14.5：

​											表14.5  表14.1的数据经规范化后的加权属性值

|      | 人均专著 | 生师比 | 科研经费 | 逾期毕业率 |
| ---- | -------- | ------ | -------- | ---------- |
| 1    | 0.0128   | 0.1791 | 0.1380   | 0.0455     |
| 2    | 0.0255   | 0.1791 | 0.1656   | 0.0542     |
| 3    | 0.0510   | 0.1493 | 0.1931   | 0.0648     |
| 4    | 0.1148   | 0.0597 | 0.2759   | 0.0222     |
| 5    | 0.1530   | 0      | 0.0110   | 0.0174     |

3. 第三步：

由上述表可得

正理想解                         $C^*=[0.1530,0.1791,0.2759,0.0174]$

负理想解                         $C^0=[0.0128,0,0.0110,0.0648]$

4. 第四步：

求各方案到正理想解的距离和负理想解的距离，见下表14.6：

​                                                  表14.6    距离值及综合指标值

|      | $s_i^*$ | $s_i^0$ | $f_i^*$ |
| ---- | ------- | ------- | ------- |
| 1    | 0.1987  | 0.2204  | 0.5258  |
| 2    | 0.1726  | 0.2371  | 0.5787  |
| 3    | 0.1428  | 0.2385  | 0.6255  |
| 4    | 0.1255  | 0.2932  | 0.7003  |
| 5    | 0.3198  | 0.1481  | 0.3165  |

5. 第五步：

计算排序指标值$f_i^*$，由$f_i^*$值的大小确定各方案由优到劣的次序为：4，3，2，1，5

##### 4.4 Matlab代码实现

```
clc,clear
a=[0.1 5 5000 4.7
   0.2 6 6000 5.6
   0.4 7 7000 6.7
   0.9 10 10000 2.3
   1.2 2 400 1.8];
[m,n]=size(a);
x2=@(qujian,lb,ub,x)(1-(qujian(1)-x)./(qujian(1)-lb)).*...
(x>=lb&x<qujian(1))+(x>=qujian(1)&x<=qujian(2))+...
(1-(x-qujian(2))./(ub-qujian(2))).*(x>qujian(2)&x<=ub);
qujian=[5,6];lb=2;ub=12;     
a(:,2)=x2(qujian,lb,ub,a(:,2));       %对属性2进行变换
b=a./vecnorm(a)                       %利用矩阵广播进行向量规范化
w=[0.2 0.3 0.4 0.1];                  
c=b.*w;                               %利用矩阵广播求加权矩阵
Cstar=max(c);                         %求正理想解
Cstar(4)=min(c(:,4))                  %属性4为成本型的
C0=min(c);                            %q求负理想解
C0(4)=max(c(:,4))                     %属性4为成本型的
Sstar=vecnorm(c-Cstar,2,2)            %逐行计算2范数即到正理想解的距离
S0=vecnorm(c-C0,2,2)                  %逐行计算2范数即到负理想解的距离
f=S0./(Sstar+S0)                      
[sf,ind]=sort(f,'descend')            %求排序结果



```

计算表14.2：

~~~
clc,clear
x2=@ (qujian,lb,ub,x)(1-(qujian(1)-x)./(qujian(1)-lb)).*...
(x>=lb&x<qujian(1))+(x>=qujian(1)&x<=qujian(2))+...
(1-(x-qujian(2))./(ub-qujian(2))).*(x>qujian(2)&x<=ub);
qujian=[5,6];lb=2;ub=12;     %最优区间，无法容忍上下界
x2data=[5 6 7 10 2]';        %x2属性值
y2=x2(qujian,lb,ub,x2data)   %调用匿名函数，进行数据变换
~~~

#### 5. 参考资料

1. 《数学建模算法与应用》P410-P416

[^1]: 正理想解$C^*$是方案集**D**中并不存在的虚拟的最佳方案，它的每个属性值都是决策矩阵中该属性的最优值（负理想解$C^0$反之）；
[^2]: 设研究生院的生师比最优区间为[5,6]，$a_2^{'}=2$,$a_2^{"}=12$。