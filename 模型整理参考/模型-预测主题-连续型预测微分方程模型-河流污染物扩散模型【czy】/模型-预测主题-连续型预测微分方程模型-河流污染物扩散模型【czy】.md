[TOC]

### 河流污染物扩散模型

#### 1. 适用范围

水质模型是一个用于描述物质在水中混合、迁移等变化过程[^1]的数学方程，即描述水体中污染物与时间、空间的定量关系。[^2]

#### 2. 常见类型

##### 2.1 模型1（完全混合模型）

###### 2.1.1 适用条件

下游某点废水和和河水中的**持久性污染物**在整个断面上达到了均匀混合。

完全混合模型适合**无支流和其他排污口进入的河流**（如下图第二个类型）

![屏幕截图 2022-01-25 104615](C:\Users\Lenovo\Desktop\屏幕截图 2022-01-25 104615.png)

###### 2.1.2 参数说明

​	                                            $Q_h$-河水流量，$m^3/s$;

​												$C_h$-河水背景段的污染物浓度，$mg/L$; 

​												$C_P$-废水中污染物的浓度，$mg/L$; 

​												$Q_P$-废水的流量，$m^3/s$; 

​												$C$-完全混合的水质浓度，$mg/L$;

###### 2.1.3 模型表达式  

在最早出现的水质完全混合断面有：
$$
C=\frac{C_hQ_h+C_PQ_P}{Q_h+Q_P}
$$
##### 2.2 模型2（零维水质模型）

###### 2.2.1 模型假设

​		零维是一种理想状态，把所研究的水体如一条河流或一个水库看成一个完整的体系，当污染物进入这个体系后，**立即均匀的分散到这个体系中**，污染物的浓度不会随时间的变化而变化。

###### 2.2.2 参数说明

​	                                            $C$-流出河段的污染物浓度，$mg/L$; 

​												$C_0$-完全混合模型计算出的浓度值，$mg/L$;

 												$x$-河段长度，$m$;

 												$k$-污染物的衰减速率常数,$1/d$;

 												$u$-河水的流速，$m/s$; 

​												 $t$-两个断面之间的流动时间;

###### 2.2.3 适用条件

 对于较浅、较窄的河流，如果不考虑污染物的降解时，当满足下列两个条件之一时的环境问题可化为零维模型：

(1)河水流量与污水流量之比大于20；

(2)不需要考虑污水进入水体的混合距离。

一般用于持久性污染物

###### 2.2.3 模型表达式

混合均匀后又经过$x$m的河段，则$x$m的河段处污染物的浓度
$$
C=\frac{C_0}{1+kt}=\frac{C_0}{1+k(\frac{x}{86400u})}
$$
##### 2.3 模型3（一维水质模型）

###### 2.3.1 模型假设

一维模型适用的假设条件是横向和垂直方向混合相当快，认为**断面中的污染物的浓度是均匀的**，或者是根据水质管理的精确度要求不考虑混合过程而假设在排污口断面**瞬时**完成充分混合。 

###### 2.3.2 参数说明

1. 

​                                                    L----混合过程段的长度

​													B----河流宽度

​													A----排放口距岸边的距离($0\leq a<0.5B$)

​													u----河流断面的平均流速

​													H----平均水深

​													g----重力加速度，9.81$m/s^2$

​													 I----河流坡度

2. 

   ​                                            $C$----下游某一点的污染物浓度,$mg/L$

   ​											$C_0$----完全混合断面的污染物浓度,$mg/L$

   ​											$u$----河水的流速,$m/s$

   ​											$D$----x方向上的扩散系数,$m^2/s$

   ​											$k_1$----污染物降解的速率常数,$(1/d)$

   ​											$x$----下游某一点到排放点的距离,$m$

###### 2.3.3 适用条件

1. 适用于符合一维动力学降解规律的一般污染物，如氰，酚，有机毒物，重金属，BOD,COD等单项指标的污染物。

![1111](C:\Users\Lenovo\Desktop\1111.png)

2. **点源一维模型的应用条件**

   如果河段长度大于L时，可采用一维模型(或者0维)进行模拟
   $$
   L=\frac{(0.4B-0.6a)uB}{(0.058H+0.0065B)\sqrt{gHI}}
   $$

###### 2.3.4 模型表达式

1. 考虑弥散的一维稳态模型
   $$
   m=\sqrt{1+\frac{4k_1D}{86400u^2}}\\
   C=C_0exp[\frac{u}{2D}(1-m)x]
   $$
   

2. 忽略弥散的一维稳态模型
   $$
   C=C_0exp(-k_1\frac{x}{86400u})
   $$

##### 2.4 模型4（二维水质模型）

###### 2.4.1 模型假设

在利用数学模式预测河流水质时，充分混合段可以采用一维模式或零维模式预测断面平均水质；混合过程段需采用二维模式进行预测。混合过程段位于完全混合段之前，完全混合段是指污染物浓度在断面上均匀分布的河段，当断面上任意一点的浓度与断面平均浓度之差小于平均浓度的5%时，可以认为达到均匀分布。

![333](C:\Users\Lenovo\Desktop\333.png)

###### 2.4.2 参数说明

 							   $x$-预测点离排放点的距离,$m$ 

​								$y$-预测点离排放点的距离,$m$

​								$c$-预测点$(x,y)$处污染物的浓度,$mg/L$

​								$c_p$-污水中污染物的浓度,$mg/L$

​							   $Q_p$-污水流量,$m^3/s$

​								$c_h$-河流上游污染物的浓度(本底浓度),$mg/L$;

​							   $H$-河流平均水深,$m$

​							   $M_y$-河流横向混合(弥散)系数,$m^2/s$

​								$u$-河流流速,$m/s$

​								$B$-河流平均宽度,$m$

​								$\pi$-圆周率

###### 2.4.3 适用条件

1. 污水进入水体后，不能在短距离内达到全断面混合均匀的河流均应采用二维模型。
2. 实际应用中，水面平均宽度超过200m的河流应采用二维模型。

###### 2.4.4 模型表达式

下列两个式子要求河流在截面上近似矩形，且**岸边排放**

 利用二维混合模型则有：
$$
c(x,y)=c_h+\frac{c_pQ_p}{H\sqrt{\pi M_yxu}}\{exp(-\frac{uy^2}{4M_yx})+exp[-\frac{u(2B-y)^2}{4M_yx}]\}
$$
利用二维衰减模型则有：
$$
c(x,y)=exp(-K_1\frac{x}{86400u})\{c_h+\frac{c_pQ_p}{H\sqrt{\pi M_yxu}}\{exp(-\frac{uy^2}{4M_yx})+exp[-\frac{u(2B-y)^2}{4M_yx}]\}
$$
#### 4. 实例

##### 4.1 例一：完全混合模型

1. 题目描述

   计划在河边建一座工厂，该厂将以$2. 83m^3/s$的 流量排放废水，废水中总溶解固体（总可滤残渣和总不可滤残渣）浓度为$1300mg/L$,该河流 平均流速为$0. 457m/s$,平均河宽为$13. 7m$,平均水深为$0.61m$,总溶解固体浓度为$310mg/L$,**如果该工厂的废水排入河中能与河水迅速混合**,那么总溶解固体的浓度是否超标（设标准为$500mg/L$）

2. 解法
   $$
   C=\frac{C_hQ_h+C_PQ_P}{Q_h+Q_P}=\frac{310\times0.457\times13.72\times0.61+1300\times2.83}{0.457\times13.72\times0.61+2.83}=731 mg/L
   $$
   所以**超标**

##### 4.2 例二：零维模型

1. 题目描述

   有一条比较浅而窄的河流，有一段长$1km$的河段，稳定排放含酚废水$1m^3/s$,含酚浓度为$200mg/L$,上游河水流量为$9m^3/s$,河流含酚浓度为0，河流平均流速为40$km/d$,酚的衰减速率常数$k=2$,求河段出口处的河水含酚浓度为多少？

2. 解法
   $$
   C_0=\frac{C_hQ_h+C_PQ_P}{Q_h+Q_P}=\frac{200\times1}{9+1}=20 mg/L
   $$

   $$
   C=\frac{C_0}{1+kt}=\frac{20}{1+2\times\frac{1}{40}}=19mg/L
   $$


##### 4.3 例三：点源一维模型的应用条件

1. 题目描述

   某河流预测河段平均宽度50米，平均水深1.2米，河底坡度0.0009，平均流速0.1$m/s$，排放口到岸边的距离0米，混合过程长度是多少米？

2. 解法
   $$
   L=\frac{(0.4\times50-0.6\times0)\times50\times0.1}{(0.058\times1.2+0.0065\times50)\sqrt{9.8\times1.2\times0.0009}}=2463米
   $$

##### 4.4 例四：一维模型

1. 题目描述

   一个改扩工程拟向河流排放废水，废水量为$0.15m^3/s$,苯酚浓度为$30mg/L$,河流流量为$5.5m^3/s$,流速为$0.3m/s$,苯酚背景浓度为$0.5mg/L$,苯酚降解系数为$k=0.2/d$,纵向弥散系数D为$10m^2/s$。求排放点下游$10km$处的苯酚浓度

2. 解法

   2.1 考虑弥散
   $$
   m=\sqrt{1+\frac{4k_1D}{86400u^2}}=\sqrt{1+\frac{4\times0.2\times10}{86400\times0.3\times0.3}}=1.000514271\\
   C_0=\frac{C_hQ_h+C_PQ_P}{Q_h+Q_P}=\frac{0.5\times5.5+30\times0.15}{5.5+0.15}=1.2832 mg/L\\
   C=C_0exp[\frac{u}{2D}(1-m)x]=1.2832exp[\frac{0.3}{2\times10}(1-1.000514271)\times10000]=1.19mg/L
   $$
    2.2 不考虑弥散
   $$
   C=C_0exp(-k_1\frac{x}{86400u})=1.2832exp(-0.2\frac{10000}{86400\times0.3})=1.19mg/L
   $$
   

   可以看出，在稳态条件下，忽略弥散系数和考虑弥散系数的差异很小，常可以忽略

#### 5. 代码实现

##### 5.1 灰色预测在matlab的实现

###### 5.1.1 例一

~~~matlab
function riverpollution()
x = 0.0:1.0:30.0;
m = getDistribution(x);
plot(x,m);%进行画图
grid on
xlabel('concentration');
ylabel('x');
title("The concentration of pollutants and the position curve")
function re = getDistribution(x)
cz = 30;%污水中某种污染物的浓度,单位为mg/L
c1 = 0.5;%河流中某种污染物的本底浓度,单位为mg/L
u = 0.3;%断面的平均流速,单位为m/s
q=0.15;%排入污水的流量,单位为m^3/s
Q = 5.5;%河流流量,单位为m^3/s
K = 0.3;%#污染物的衰减速度常数,单位为/day
D = 10;%纵向弥散系数,单位为m^2/s
C = (c1*Q+cz*q)/(Q+q);
re =C*exp(u*x/(2*D)*(1-sqrt(1+4*K*D/(u*u)))); 
end
~~~

###### 5.1.2 例二

~~~matlab
function guerrilla_battle()
x = [35,30,25,20,15,10,5];
y = 20;
for s = x
        m = ReturnM(s,y);
        t1 =0.0:0.05:20.0;%设置一个0到30的考察范围
        plot(t1, returnY(m,t1), 'k');
        hold on
grid on
xlabel('y(t)');
ylabel('x(t)');
title("guerrilla warfare model");

function re = ReturnM(x0,y0)
ry = 0.75;
rx = 0.5;
Sry = 0.1;%乙方一次射击的有效面积
Srx = 0.2;%乙方一次射击的有效面积
Sx = 0.15;%甲方活动面积
Sy = 0.10;%乙方的活动面积
c = ry*Sry/Sx;%ry为命中率，本来该使用命中率，我们游击战中命中率为有效面积Sry与甲方活动面积之比Sx,同理甲方也是一样
d = rx*Srx/Sy;%按照c站在甲方的角度理解即可
re = c*y0-d*x0;

function re = returnY(m,x1)
ry = 0.75;
rx = 0.5;
Sry = 0.1;%乙方一次射击的有效面积
Srx = 0.2;%乙方一次射击的有效面积
Sx = 0.15;%甲方活动面积
Sy = 0.10;%乙方的活动面积
c = ry*Sry/Sx;%ry为命中率，本来该使用命中率，我们游击战中命中率为有效面积Sry与甲方活动面积之比Sx,同理甲方也是一样
d = rx*Srx/Sy;%按照c站在甲方的角度理解即可
re = (m+d*x1)/c;

end
~~~

##### 5.2 灰色预测在python的实现

~~~python
#################################################  
# kmeans: river pollution
# MCM2018 Python3.5代码模板 SJTU    
# By:Tan xiao
#################################################
# 可能需要根据实际情况更改的部分和注意事项：
# 1.本代码只考虑了河流污染物处于稳态的情况，水中的污染物分布状况也稳定的
# 2.数据输入部分，要有相应的格式,我们直接才用我们直接才用input的方式
# 3.可视化部分做了一维的
# 4.可视化部分的具体细节根据个人需求而定
################################################

##导入库
import numpy as np
import time
import matplotlib.pyplot as plt
#部分常量的定义
cz = 30#污水中某种污染物的浓度,单位为mg/L
c1 = 0.5#河流中某种污染物的本底浓度,单位为mg/L
u = 0.3#断面的平均流速,单位为m/s
q=0.15#排入污水的流量,单位为m^3/s
Q = 5.5#河流流量,单位为m^3/s
K = 0.2#污染物的衰减速度常数,单位为/day
D = 10#纵向弥散系数,单位为m^2/s
def unidimensionalCompute(x):
    C = (c1*Q+cz*q)/(Q+q)
    return C*np.exp(u*x/(2*D)*(1-np.sqrt(1+4*K*D/(u*u))))#我们解出的位置与污染物浓度方程
def unidimensionalPlot():
    t1 = np.arange(0.0, 30.0, 0.1)#设置一个0到30的考察范围
    plt.plot(t1, unidimensionalCompute(t1), 'k')
    plt.title("The relation curve of pollutant concentration and position")
    plt.ylabel("concentration")
    plt.xlabel("x")
    plt.show()
def main():
    unidimensionalPlot()
if __name__ == "__main__":
    main()

~~~

#### 6. 参考资料

1.  [数学建模培训营----河流污染物扩散模型](https://anl.sjtu.edu.cn/mcm/docs/1%E6%A8%A1%E5%9E%8B/7%E9%A2%84%E6%B5%8B%E4%B8%BB%E9%A2%98/3%E8%BF%9E%E7%BB%AD%E5%9E%8B%E9%A2%84%E6%B5%8B%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B/%E6%B2%B3%E6%B5%81%E6%B1%A1%E6%9F%93%E7%89%A9%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/doc)
2.  [水质模型](https://wenku.baidu.com/view/958a2a12cd22bcd126fff705cc17552707225eac.html)

[^1]: 当污染物排放入水体中后，会经历一个混合的过程，直至完全混合均匀。
[^2]: 在环境介质中处于稳定流动状态和污染源稳定排放的条件下，环境中的污染物分布状况也是稳定的。这时，污染物在某一空间位置的浓度不随时间变化，这种不随时间变化的状态称为**稳态**。

