clear,clc;
% machineNum = xlsread('alarm.xlsx','A1:A50');
% loop = xlsread('alarm.xlsx','B1:B50');
% comp = xlsread('alarm.xlsx','E1:E50');
% obj = xlsread('alarm.xlsx','I1:I50');
% result = xlsread('alarm.xlsx','K1:K50');
% 
k = 50;

data = readtable('alarm.xlsx');
machinenum = table2array(data(1:k,1));
loop = table2array(data(1:k,2));
alarmNum = table2array(data(1:k,6));
obj = string(table2cell(data(1:k,9)));
result = string(table2cell(data(1:k,11)));
case1 = "是 (True)"; case2 = "否，其中有1次为真实火灾 (False, one of them was a real fire)"; case3 = "否 (False)";
index = find(result ~= case1);
num = 0;

for i = index
    maxcases = 0;
    for j = find(index < i)
        if obj(index(j)) == obj(i) && machinenum(index(j)) == machinenum(i) && loop(index(j)) == loop(i)
            if result(index(j)) == case2
                temp = 1;
            else
                temp = alarmNum(index(j));
            end
            if temp > maxcases
                maxcases = temp;
            end      
        end
    end
    if result(i) == case2
        val = 1;
    else
        val = alarmNum(i);
    end
    
    
    
    if result(i) == case2
        temp = 1;
        for j = find(index < i)
            if obj(index(j)) == obj(i) && machinenum(index(j)) == machinenum(i) && loop(index(j)) == loop(i)
                temp = 0;
                break;
            end
        end
        num = num + temp;
    else
        temp = alarmNum(i);
        for j = find(index < i)
            if obj(index(j)) == obj(i) && machinenum(index(j)) == machinenum(i) && loop(index(j)) == loop(i)
                
            end
        end
        num = num + temp;
        
        
    end
    
end
